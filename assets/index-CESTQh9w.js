(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();var Ut,q,Dr,Ie,Un,Sr,Er,Tr,wn,cn,un,ct={},Ir=[],Mi=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,zt=Array.isArray;function ye(n,t){for(var e in t)n[e]=t[e];return n}function kn(n){n&&n.parentNode&&n.parentNode.removeChild(n)}function ji(n,t,e){var r,i,s,a={};for(s in t)s=="key"?r=t[s]:s=="ref"?i=t[s]:a[s]=t[s];if(arguments.length>2&&(a.children=arguments.length>3?Ut.call(arguments,2):e),typeof n=="function"&&n.defaultProps!=null)for(s in n.defaultProps)a[s]===void 0&&(a[s]=n.defaultProps[s]);return Nt(n,a,r,i,null)}function Nt(n,t,e,r,i){var s={type:n,props:t,key:e,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++Dr,__i:-1,__u:0};return i==null&&q.vnode!=null&&q.vnode(s),s}function Bt(n){return n.children}function Mt(n,t){this.props=n,this.context=t}function Ve(n,t){if(t==null)return n.__?Ve(n.__,n.__i+1):null;for(var e;t<n.__k.length;t++)if((e=n.__k[t])!=null&&e.__e!=null)return e.__e;return typeof n.type=="function"?Ve(n):null}function Ar(n){var t,e;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,t=0;t<n.__k.length;t++)if((e=n.__k[t])!=null&&e.__e!=null){n.__e=n.__c.base=e.__e;break}return Ar(n)}}function zn(n){(!n.__d&&(n.__d=!0)&&Ie.push(n)&&!$t.__r++||Un!==q.debounceRendering)&&((Un=q.debounceRendering)||Sr)($t)}function $t(){for(var n,t,e,r,i,s,a,o=1;Ie.length;)Ie.length>o&&Ie.sort(Er),n=Ie.shift(),o=Ie.length,n.__d&&(e=void 0,i=(r=(t=n).__v).__e,s=[],a=[],t.__P&&((e=ye({},r)).__v=r.__v+1,q.vnode&&q.vnode(e),xn(t.__P,e,r,t.__n,t.__P.namespaceURI,32&r.__u?[i]:null,s,i??Ve(r),!!(32&r.__u),a),e.__v=r.__v,e.__.__k[e.__i]=e,Mr(s,e,a),e.__e!=i&&Ar(e)));$t.__r=0}function Or(n,t,e,r,i,s,a,o,l,d,u){var f,g,v,k,b,x,T=r&&r.__k||Ir,y=t.length;for(l=Pi(e,t,T,l,y),f=0;f<y;f++)(v=e.__k[f])!=null&&(g=v.__i===-1?ct:T[v.__i]||ct,v.__i=f,x=xn(n,v,g,i,s,a,o,l,d,u),k=v.__e,v.ref&&g.ref!=v.ref&&(g.ref&&Cn(g.ref,null,v),u.push(v.ref,v.__c||k,v)),b==null&&k!=null&&(b=k),4&v.__u||g.__k===v.__k?l=Nr(v,l,n):typeof v.type=="function"&&x!==void 0?l=x:k&&(l=k.nextSibling),v.__u&=-7);return e.__e=b,l}function Pi(n,t,e,r,i){var s,a,o,l,d,u=e.length,f=u,g=0;for(n.__k=new Array(i),s=0;s<i;s++)(a=t[s])!=null&&typeof a!="boolean"&&typeof a!="function"?(l=s+g,(a=n.__k[s]=typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?Nt(null,a,null,null,null):zt(a)?Nt(Bt,{children:a},null,null,null):a.constructor===void 0&&a.__b>0?Nt(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=n,a.__b=n.__b+1,o=null,(d=a.__i=$i(a,e,l,f))!==-1&&(f--,(o=e[d])&&(o.__u|=2)),o==null||o.__v===null?(d==-1&&(i>u?g--:i<u&&g++),typeof a.type!="function"&&(a.__u|=4)):d!=l&&(d==l-1?g--:d==l+1?g++:(d>l?g--:g++,a.__u|=4))):n.__k[s]=null;if(f)for(s=0;s<u;s++)(o=e[s])!=null&&(2&o.__u)==0&&(o.__e==r&&(r=Ve(o)),Pr(o,o));return r}function Nr(n,t,e){var r,i;if(typeof n.type=="function"){for(r=n.__k,i=0;r&&i<r.length;i++)r[i]&&(r[i].__=n,t=Nr(r[i],t,e));return t}n.__e!=t&&(t&&n.type&&!e.contains(t)&&(t=Ve(n)),e.insertBefore(n.__e,t||null),t=n.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function $i(n,t,e,r){var i,s,a=n.key,o=n.type,l=t[e];if(l===null&&n.key==null||l&&a==l.key&&o===l.type&&(2&l.__u)==0)return e;if(r>(l!=null&&(2&l.__u)==0?1:0))for(i=e-1,s=e+1;i>=0||s<t.length;){if(i>=0){if((l=t[i])&&(2&l.__u)==0&&a==l.key&&o===l.type)return i;i--}if(s<t.length){if((l=t[s])&&(2&l.__u)==0&&a==l.key&&o===l.type)return s;s++}}return-1}function Bn(n,t,e){t[0]=="-"?n.setProperty(t,e??""):n[t]=e==null?"":typeof e!="number"||Mi.test(t)?e:e+"px"}function Ct(n,t,e,r,i){var s;e:if(t=="style")if(typeof e=="string")n.style.cssText=e;else{if(typeof r=="string"&&(n.style.cssText=r=""),r)for(t in r)e&&t in e||Bn(n.style,t,"");if(e)for(t in e)r&&e[t]===r[t]||Bn(n.style,t,e[t])}else if(t[0]=="o"&&t[1]=="n")s=t!=(t=t.replace(Tr,"$1")),t=t.toLowerCase()in n||t=="onFocusOut"||t=="onFocusIn"?t.toLowerCase().slice(2):t.slice(2),n.l||(n.l={}),n.l[t+s]=e,e?r?e.t=r.t:(e.t=wn,n.addEventListener(t,s?un:cn,s)):n.removeEventListener(t,s?un:cn,s);else{if(i=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in n)try{n[t]=e??"";break e}catch{}typeof e=="function"||(e==null||e===!1&&t[4]!="-"?n.removeAttribute(t):n.setAttribute(t,t=="popover"&&e==1?"":e))}}function Hn(n){return function(t){if(this.l){var e=this.l[t.type+n];if(t.u==null)t.u=wn++;else if(t.u<e.t)return;return e(q.event?q.event(t):t)}}}function xn(n,t,e,r,i,s,a,o,l,d){var u,f,g,v,k,b,x,T,y,I,w,O,R,Y,H,U,ee,K=t.type;if(t.constructor!==void 0)return null;128&e.__u&&(l=!!(32&e.__u),s=[o=t.__e=e.__e]),(u=q.__b)&&u(t);e:if(typeof K=="function")try{if(T=t.props,y="prototype"in K&&K.prototype.render,I=(u=K.contextType)&&r[u.__c],w=u?I?I.props.value:u.__:r,e.__c?x=(f=t.__c=e.__c).__=f.__E:(y?t.__c=f=new K(T,w):(t.__c=f=new Mt(T,w),f.constructor=K,f.render=Ri),I&&I.sub(f),f.props=T,f.state||(f.state={}),f.context=w,f.__n=r,g=f.__d=!0,f.__h=[],f._sb=[]),y&&f.__s==null&&(f.__s=f.state),y&&K.getDerivedStateFromProps!=null&&(f.__s==f.state&&(f.__s=ye({},f.__s)),ye(f.__s,K.getDerivedStateFromProps(T,f.__s))),v=f.props,k=f.state,f.__v=t,g)y&&K.getDerivedStateFromProps==null&&f.componentWillMount!=null&&f.componentWillMount(),y&&f.componentDidMount!=null&&f.__h.push(f.componentDidMount);else{if(y&&K.getDerivedStateFromProps==null&&T!==v&&f.componentWillReceiveProps!=null&&f.componentWillReceiveProps(T,w),!f.__e&&(f.shouldComponentUpdate!=null&&f.shouldComponentUpdate(T,f.__s,w)===!1||t.__v==e.__v)){for(t.__v!=e.__v&&(f.props=T,f.state=f.__s,f.__d=!1),t.__e=e.__e,t.__k=e.__k,t.__k.some(function(Z){Z&&(Z.__=t)}),O=0;O<f._sb.length;O++)f.__h.push(f._sb[O]);f._sb=[],f.__h.length&&a.push(f);break e}f.componentWillUpdate!=null&&f.componentWillUpdate(T,f.__s,w),y&&f.componentDidUpdate!=null&&f.__h.push(function(){f.componentDidUpdate(v,k,b)})}if(f.context=w,f.props=T,f.__P=n,f.__e=!1,R=q.__r,Y=0,y){for(f.state=f.__s,f.__d=!1,R&&R(t),u=f.render(f.props,f.state,f.context),H=0;H<f._sb.length;H++)f.__h.push(f._sb[H]);f._sb=[]}else do f.__d=!1,R&&R(t),u=f.render(f.props,f.state,f.context),f.state=f.__s;while(f.__d&&++Y<25);f.state=f.__s,f.getChildContext!=null&&(r=ye(ye({},r),f.getChildContext())),y&&!g&&f.getSnapshotBeforeUpdate!=null&&(b=f.getSnapshotBeforeUpdate(v,k)),U=u,u!=null&&u.type===Bt&&u.key==null&&(U=jr(u.props.children)),o=Or(n,zt(U)?U:[U],t,e,r,i,s,a,o,l,d),f.base=t.__e,t.__u&=-161,f.__h.length&&a.push(f),x&&(f.__E=f.__=null)}catch(Z){if(t.__v=null,l||s!=null)if(Z.then){for(t.__u|=l?160:128;o&&o.nodeType==8&&o.nextSibling;)o=o.nextSibling;s[s.indexOf(o)]=null,t.__e=o}else for(ee=s.length;ee--;)kn(s[ee]);else t.__e=e.__e,t.__k=e.__k;q.__e(Z,t,e)}else s==null&&t.__v==e.__v?(t.__k=e.__k,t.__e=e.__e):o=t.__e=Fi(e.__e,t,e,r,i,s,a,l,d);return(u=q.diffed)&&u(t),128&t.__u?void 0:o}function Mr(n,t,e){for(var r=0;r<e.length;r++)Cn(e[r],e[++r],e[++r]);q.__c&&q.__c(t,n),n.some(function(i){try{n=i.__h,i.__h=[],n.some(function(s){s.call(i)})}catch(s){q.__e(s,i.__v)}})}function jr(n){return typeof n!="object"||n==null?n:zt(n)?n.map(jr):ye({},n)}function Fi(n,t,e,r,i,s,a,o,l){var d,u,f,g,v,k,b,x=e.props,T=t.props,y=t.type;if(y=="svg"?i="http://www.w3.org/2000/svg":y=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),s!=null){for(d=0;d<s.length;d++)if((v=s[d])&&"setAttribute"in v==!!y&&(y?v.localName==y:v.nodeType==3)){n=v,s[d]=null;break}}if(n==null){if(y==null)return document.createTextNode(T);n=document.createElementNS(i,y,T.is&&T),o&&(q.__m&&q.__m(t,s),o=!1),s=null}if(y===null)x===T||o&&n.data===T||(n.data=T);else{if(s=s&&Ut.call(n.childNodes),x=e.props||ct,!o&&s!=null)for(x={},d=0;d<n.attributes.length;d++)x[(v=n.attributes[d]).name]=v.value;for(d in x)if(v=x[d],d!="children"){if(d=="dangerouslySetInnerHTML")f=v;else if(!(d in T)){if(d=="value"&&"defaultValue"in T||d=="checked"&&"defaultChecked"in T)continue;Ct(n,d,null,v,i)}}for(d in T)v=T[d],d=="children"?g=v:d=="dangerouslySetInnerHTML"?u=v:d=="value"?k=v:d=="checked"?b=v:o&&typeof v!="function"||x[d]===v||Ct(n,d,v,x[d],i);if(u)o||f&&(u.__html===f.__html||u.__html===n.innerHTML)||(n.innerHTML=u.__html),t.__k=[];else if(f&&(n.innerHTML=""),Or(t.type==="template"?n.content:n,zt(g)?g:[g],t,e,r,y=="foreignObject"?"http://www.w3.org/1999/xhtml":i,s,a,s?s[0]:e.__k&&Ve(e,0),o,l),s!=null)for(d=s.length;d--;)kn(s[d]);o||(d="value",y=="progress"&&k==null?n.removeAttribute("value"):k!==void 0&&(k!==n[d]||y=="progress"&&!k||y=="option"&&k!==x[d])&&Ct(n,d,k,x[d],i),d="checked",b!==void 0&&b!==n[d]&&Ct(n,d,b,x[d],i))}return n}function Cn(n,t,e){try{if(typeof n=="function"){var r=typeof n.__u=="function";r&&n.__u(),r&&t==null||(n.__u=n(t))}else n.current=t}catch(i){q.__e(i,e)}}function Pr(n,t,e){var r,i;if(q.unmount&&q.unmount(n),(r=n.ref)&&(r.current&&r.current!==n.__e||Cn(r,null,t)),(r=n.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(s){q.__e(s,t)}r.base=r.__P=null}if(r=n.__k)for(i=0;i<r.length;i++)r[i]&&Pr(r[i],t,e||typeof n.type!="function");e||kn(n.__e),n.__c=n.__=n.__e=void 0}function Ri(n,t,e){return this.constructor(n,e)}function $r(n,t,e){var r,i,s,a;t==document&&(t=document.documentElement),q.__&&q.__(n,t),i=(r=!1)?null:t.__k,s=[],a=[],xn(t,n=t.__k=ji(Bt,null,[n]),i||ct,ct,t.namespaceURI,i?null:t.firstChild?Ut.call(t.childNodes):null,s,i?i.__e:t.firstChild,r,a),Mr(s,n,a)}Ut=Ir.slice,q={__e:function(n,t,e,r){for(var i,s,a;t=t.__;)if((i=t.__c)&&!i.__)try{if((s=i.constructor)&&s.getDerivedStateFromError!=null&&(i.setState(s.getDerivedStateFromError(n)),a=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(n,r||{}),a=i.__d),a)return i.__E=i}catch(o){n=o}throw n}},Dr=0,Mt.prototype.setState=function(n,t){var e;e=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=ye({},this.state),typeof n=="function"&&(n=n(ye({},e),this.props)),n&&ye(e,n),n!=null&&this.__v&&(t&&this._sb.push(t),zn(this))},Mt.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),zn(this))},Mt.prototype.render=Bt,Ie=[],Sr=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Er=function(n,t){return n.__v.__b-t.__v.__b},$t.__r=0,Tr=/(PointerCapture)$|Capture$/i,wn=0,cn=Hn(!1),un=Hn(!0);var Li=0;function m(n,t,e,r,i,s){t||(t={});var a,o,l=t;if("ref"in l)for(o in l={},t)o=="ref"?a=t[o]:l[o]=t[o];var d={type:n,props:l,key:e,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Li,__i:-1,__u:0,__source:i,__self:s};if(typeof n=="function"&&(a=n.defaultProps))for(o in a)l[o]===void 0&&(l[o]=a[o]);return q.vnode&&q.vnode(d),d}var ut,G,Gt,Jn,Ft=0,Fr=[],X=q,qn=X.__b,Wn=X.__r,Yn=X.diffed,Kn=X.__c,Vn=X.unmount,Gn=X.__;function Dn(n,t){X.__h&&X.__h(G,n,Ft||t),Ft=0;var e=G.__H||(G.__H={__:[],__h:[]});return n>=e.__.length&&e.__.push({}),e.__[n]}function F(n){return Ft=1,Ui(Ur,n)}function Ui(n,t,e){var r=Dn(ut++,2);if(r.t=n,!r.__c&&(r.__=[Ur(void 0,t),function(o){var l=r.__N?r.__N[0]:r.__[0],d=r.t(l,o);l!==d&&(r.__N=[d,r.__[1]],r.__c.setState({}))}],r.__c=G,!G.__f)){var i=function(o,l,d){if(!r.__c.__H)return!0;var u=r.__c.__H.__.filter(function(g){return!!g.__c});if(u.every(function(g){return!g.__N}))return!s||s.call(this,o,l,d);var f=r.__c.props!==o;return u.forEach(function(g){if(g.__N){var v=g.__[0];g.__=g.__N,g.__N=void 0,v!==g.__[0]&&(f=!0)}}),s&&s.call(this,o,l,d)||f};G.__f=!0;var s=G.shouldComponentUpdate,a=G.componentWillUpdate;G.componentWillUpdate=function(o,l,d){if(this.__e){var u=s;s=void 0,i(o,l,d),s=u}a&&a.call(this,o,l,d)},G.shouldComponentUpdate=i}return r.__N||r.__}function Ge(n,t){var e=Dn(ut++,3);!X.__s&&Lr(e.__H,t)&&(e.__=n,e.u=t,G.__H.__h.push(e))}function Rr(n){return Ft=5,zi(function(){return{current:n}},[])}function zi(n,t){var e=Dn(ut++,7);return Lr(e.__H,t)&&(e.__=n(),e.__H=t,e.__h=n),e.__}function Bi(){for(var n;n=Fr.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(jt),n.__H.__h.forEach(dn),n.__H.__h=[]}catch(t){n.__H.__h=[],X.__e(t,n.__v)}}X.__b=function(n){G=null,qn&&qn(n)},X.__=function(n,t){n&&t.__k&&t.__k.__m&&(n.__m=t.__k.__m),Gn&&Gn(n,t)},X.__r=function(n){Wn&&Wn(n),ut=0;var t=(G=n.__c).__H;t&&(Gt===G?(t.__h=[],G.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.u=e.__N=void 0})):(t.__h.forEach(jt),t.__h.forEach(dn),t.__h=[],ut=0)),Gt=G},X.diffed=function(n){Yn&&Yn(n);var t=n.__c;t&&t.__H&&(t.__H.__h.length&&(Fr.push(t)!==1&&Jn===X.requestAnimationFrame||((Jn=X.requestAnimationFrame)||Hi)(Bi)),t.__H.__.forEach(function(e){e.u&&(e.__H=e.u),e.u=void 0})),Gt=G=null},X.__c=function(n,t){t.some(function(e){try{e.__h.forEach(jt),e.__h=e.__h.filter(function(r){return!r.__||dn(r)})}catch(r){t.some(function(i){i.__h&&(i.__h=[])}),t=[],X.__e(r,e.__v)}}),Kn&&Kn(n,t)},X.unmount=function(n){Vn&&Vn(n);var t,e=n.__c;e&&e.__H&&(e.__H.__.forEach(function(r){try{jt(r)}catch(i){t=i}}),e.__H=void 0,t&&X.__e(t,e.__v))};var Zn=typeof requestAnimationFrame=="function";function Hi(n){var t,e=function(){clearTimeout(r),Zn&&cancelAnimationFrame(t),setTimeout(n)},r=setTimeout(e,100);Zn&&(t=requestAnimationFrame(e))}function jt(n){var t=G,e=n.__c;typeof e=="function"&&(n.__c=void 0,e()),G=t}function dn(n){var t=G;n.__c=n.__(),G=t}function Lr(n,t){return!n||n.length!==t.length||t.some(function(e,r){return e!==n[r]})}function Ur(n,t){return typeof t=="function"?t(n):t}const Ji="modulepreload",qi=function(n){return"/elec-bill/"+n},Xn={},Ze=function(t,e,r){let i=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(e.map(l=>{if(l=qi(l),l in Xn)return;Xn[l]=!0;const d=l.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":Ji,d||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),d)return new Promise((g,v)=>{f.addEventListener("load",g),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},Wi=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...e)=>Ze(async()=>{const{default:r}=await Promise.resolve().then(()=>Qe);return{default:r}},void 0).then(({default:r})=>r(...e)):t=fetch,(...e)=>t(...e)};class Sn extends Error{constructor(t,e="FunctionsError",r){super(t),this.name=e,this.context=r}}class Yi extends Sn{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Ki extends Sn{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Vi extends Sn{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var hn;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(hn||(hn={}));var Gi=function(n,t,e,r){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(u){try{d(r.next(u))}catch(f){a(f)}}function l(u){try{d(r.throw(u))}catch(f){a(f)}}function d(u){u.done?s(u.value):i(u.value).then(o,l)}d((r=r.apply(n,t||[])).next())})};class Zi{constructor(t,{headers:e={},customFetch:r,region:i=hn.Any}={}){this.url=t,this.headers=e,this.region=i,this.fetch=Wi(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,e={}){var r;return Gi(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:a}=e;let o={},{region:l}=e;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let d;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",d=a):typeof a=="string"?(o["Content-Type"]="text/plain",d=a):typeof FormData<"u"&&a instanceof FormData?d=a:(o["Content-Type"]="application/json",d=JSON.stringify(a)));const u=yield this.fetch(`${this.url}/${t}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:d}).catch(k=>{throw new Yi(k)}),f=u.headers.get("x-relay-error");if(f&&f==="true")throw new Ki(u);if(!u.ok)throw new Vi(u);let g=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),v;return g==="application/json"?v=yield u.json():g==="application/octet-stream"?v=yield u.blob():g==="text/event-stream"?v=u:g==="multipart/form-data"?v=yield u.formData():v=yield u.text(),{data:v,error:null}}catch(i){return{data:null,error:i}}})}}function Xi(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Qi(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var t=n.default;if(typeof t=="function"){var e=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(e,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),e}var te={},Fe={},Re={},Le={},Ue={},ze={},es=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Xe=es();const ts=Xe.fetch,zr=Xe.fetch.bind(Xe),Br=Xe.Headers,ns=Xe.Request,rs=Xe.Response,Qe=Object.freeze(Object.defineProperty({__proto__:null,Headers:Br,Request:ns,Response:rs,default:zr,fetch:ts},Symbol.toStringTag,{value:"Module"})),is=Qi(Qe);var Dt={},Qn;function Hr(){if(Qn)return Dt;Qn=1,Object.defineProperty(Dt,"__esModule",{value:!0});class n extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}return Dt.default=n,Dt}var er;function Jr(){if(er)return ze;er=1;var n=ze&&ze.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(ze,"__esModule",{value:!0});const t=n(is),e=n(Hr());class r{constructor(s){this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=s.headers,this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=s.shouldThrowOnError,this.signal=s.signal,this.isMaybeSingle=s.isMaybeSingle,s.fetch?this.fetch=s.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,a){return this.headers=Object.assign({},this.headers),this.headers[s]=a,this}then(s,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{var u,f,g;let v=null,k=null,b=null,x=d.status,T=d.statusText;if(d.ok){if(this.method!=="HEAD"){const O=await d.text();O===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?k=O:k=JSON.parse(O))}const I=(u=this.headers.Prefer)===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),w=(f=d.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");I&&w&&w.length>1&&(b=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(k)&&(k.length>1?(v={code:"PGRST116",details:`Results contain ${k.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},k=null,b=null,x=406,T="Not Acceptable"):k.length===1?k=k[0]:k=null)}else{const I=await d.text();try{v=JSON.parse(I),Array.isArray(v)&&d.status===404&&(k=[],v=null,x=200,T="OK")}catch{d.status===404&&I===""?(x=204,T="No Content"):v={message:I}}if(v&&this.isMaybeSingle&&(!((g=v==null?void 0:v.details)===null||g===void 0)&&g.includes("0 rows"))&&(v=null,x=200,T="OK"),v&&this.shouldThrowOnError)throw new e.default(v)}return{error:v,data:k,count:b,status:x,statusText:T}});return this.shouldThrowOnError||(l=l.catch(d=>{var u,f,g;return{error:{message:`${(u=d==null?void 0:d.name)!==null&&u!==void 0?u:"FetchError"}: ${d==null?void 0:d.message}`,details:`${(f=d==null?void 0:d.stack)!==null&&f!==void 0?f:""}`,hint:"",code:`${(g=d==null?void 0:d.code)!==null&&g!==void 0?g:""}`},data:null,count:null,status:0,statusText:""}})),l.then(s,a)}returns(){return this}overrideTypes(){return this}}return ze.default=r,ze}var tr;function qr(){if(tr)return Ue;tr=1;var n=Ue&&Ue.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ue,"__esModule",{value:!0});const t=n(Jr());class e extends t.default{select(i){let s=!1;const a=(i??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",a),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(i,{ascending:s=!0,nullsFirst:a,foreignTable:o,referencedTable:l=o}={}){const d=l?`${l}.order`:"order",u=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${u?`${u},`:""}${i}.${s?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:s,referencedTable:a=s}={}){const o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(o,`${i}`),this}range(i,s,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"offset":`${o}.offset`,d=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${i}`),this.url.searchParams.set(d,`${s-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:i=!1,verbose:s=!1,settings:a=!1,buffers:o=!1,wal:l=!1,format:d="text"}={}){var u;const f=[i?"analyze":null,s?"verbose":null,a?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),g=(u=this.headers.Accept)!==null&&u!==void 0?u:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${d}; for="${g}"; options=${f};`,d==="json"?this:this}rollback(){var i;return((i=this.headers.Prefer)!==null&&i!==void 0?i:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Ue.default=e,Ue}var nr;function En(){if(nr)return Le;nr=1;var n=Le&&Le.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Le,"__esModule",{value:!0});const t=n(qr());class e extends t.default{eq(i,s){return this.url.searchParams.append(i,`eq.${s}`),this}neq(i,s){return this.url.searchParams.append(i,`neq.${s}`),this}gt(i,s){return this.url.searchParams.append(i,`gt.${s}`),this}gte(i,s){return this.url.searchParams.append(i,`gte.${s}`),this}lt(i,s){return this.url.searchParams.append(i,`lt.${s}`),this}lte(i,s){return this.url.searchParams.append(i,`lte.${s}`),this}like(i,s){return this.url.searchParams.append(i,`like.${s}`),this}likeAllOf(i,s){return this.url.searchParams.append(i,`like(all).{${s.join(",")}}`),this}likeAnyOf(i,s){return this.url.searchParams.append(i,`like(any).{${s.join(",")}}`),this}ilike(i,s){return this.url.searchParams.append(i,`ilike.${s}`),this}ilikeAllOf(i,s){return this.url.searchParams.append(i,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(i,s){return this.url.searchParams.append(i,`ilike(any).{${s.join(",")}}`),this}is(i,s){return this.url.searchParams.append(i,`is.${s}`),this}in(i,s){const a=Array.from(new Set(s)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(i,`in.(${a})`),this}contains(i,s){return typeof s=="string"?this.url.searchParams.append(i,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(i,`cs.{${s.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(s)}`),this}containedBy(i,s){return typeof s=="string"?this.url.searchParams.append(i,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(i,`cd.{${s.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(s)}`),this}rangeGt(i,s){return this.url.searchParams.append(i,`sr.${s}`),this}rangeGte(i,s){return this.url.searchParams.append(i,`nxl.${s}`),this}rangeLt(i,s){return this.url.searchParams.append(i,`sl.${s}`),this}rangeLte(i,s){return this.url.searchParams.append(i,`nxr.${s}`),this}rangeAdjacent(i,s){return this.url.searchParams.append(i,`adj.${s}`),this}overlaps(i,s){return typeof s=="string"?this.url.searchParams.append(i,`ov.${s}`):this.url.searchParams.append(i,`ov.{${s.join(",")}}`),this}textSearch(i,s,{config:a,type:o}={}){let l="";o==="plain"?l="pl":o==="phrase"?l="ph":o==="websearch"&&(l="w");const d=a===void 0?"":`(${a})`;return this.url.searchParams.append(i,`${l}fts${d}.${s}`),this}match(i){return Object.entries(i).forEach(([s,a])=>{this.url.searchParams.append(s,`eq.${a}`)}),this}not(i,s,a){return this.url.searchParams.append(i,`not.${s}.${a}`),this}or(i,{foreignTable:s,referencedTable:a=s}={}){const o=a?`${a}.or`:"or";return this.url.searchParams.append(o,`(${i})`),this}filter(i,s,a){return this.url.searchParams.append(i,`${s}.${a}`),this}}return Le.default=e,Le}var rr;function Wr(){if(rr)return Re;rr=1;var n=Re&&Re.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Re,"__esModule",{value:!0});const t=n(En());class e{constructor(i,{headers:s={},schema:a,fetch:o}){this.url=i,this.headers=s,this.schema=a,this.fetch=o}select(i,{head:s=!1,count:a}={}){const o=s?"HEAD":"GET";let l=!1;const d=(i??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",d),a&&(this.headers.Prefer=`count=${a}`),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(i,{count:s,defaultToNull:a=!0}={}){const o="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),s&&l.push(`count=${s}`),a||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(i)){const d=i.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(d.length>0){const u=[...new Set(d)].map(f=>`"${f}"`);this.url.searchParams.set("columns",u.join(","))}}return new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}upsert(i,{onConflict:s,ignoreDuplicates:a=!1,count:o,defaultToNull:l=!0}={}){const d="POST",u=[`resolution=${a?"ignore":"merge"}-duplicates`];if(s!==void 0&&this.url.searchParams.set("on_conflict",s),this.headers.Prefer&&u.push(this.headers.Prefer),o&&u.push(`count=${o}`),l||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(i)){const f=i.reduce((g,v)=>g.concat(Object.keys(v)),[]);if(f.length>0){const g=[...new Set(f)].map(v=>`"${v}"`);this.url.searchParams.set("columns",g.join(","))}}return new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}update(i,{count:s}={}){const a="PATCH",o=[];return this.headers.Prefer&&o.push(this.headers.Prefer),s&&o.push(`count=${s}`),this.headers.Prefer=o.join(","),new t.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}delete({count:i}={}){const s="DELETE",a=[];return i&&a.push(`count=${i}`),this.headers.Prefer&&a.unshift(this.headers.Prefer),this.headers.Prefer=a.join(","),new t.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Re.default=e,Re}var tt={},nt={},ir;function ss(){return ir||(ir=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.version=void 0,nt.version="0.0.0-automated"),nt}var sr;function as(){if(sr)return tt;sr=1,Object.defineProperty(tt,"__esModule",{value:!0}),tt.DEFAULT_HEADERS=void 0;const n=ss();return tt.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`},tt}var ar;function os(){if(ar)return Fe;ar=1;var n=Fe&&Fe.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Fe,"__esModule",{value:!0});const t=n(Wr()),e=n(En()),r=as();class i{constructor(a,{headers:o={},schema:l,fetch:d}={}){this.url=a,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),o),this.schemaName=l,this.fetch=d}from(a){const o=new URL(`${this.url}/${a}`);return new t.default(o,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new i(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:l=!1,get:d=!1,count:u}={}){let f;const g=new URL(`${this.url}/rpc/${a}`);let v;l||d?(f=l?"HEAD":"GET",Object.entries(o).filter(([b,x])=>x!==void 0).map(([b,x])=>[b,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([b,x])=>{g.searchParams.append(b,x)})):(f="POST",v=o);const k=Object.assign({},this.headers);return u&&(k.Prefer=`count=${u}`),new e.default({method:f,url:g,headers:k,schema:this.schemaName,body:v,fetch:this.fetch,allowEmpty:!1})}}return Fe.default=i,Fe}var or;function ls(){if(or)return te;or=1;var n=te&&te.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(te,"__esModule",{value:!0}),te.PostgrestError=te.PostgrestBuilder=te.PostgrestTransformBuilder=te.PostgrestFilterBuilder=te.PostgrestQueryBuilder=te.PostgrestClient=void 0;const t=n(os());te.PostgrestClient=t.default;const e=n(Wr());te.PostgrestQueryBuilder=e.default;const r=n(En());te.PostgrestFilterBuilder=r.default;const i=n(qr());te.PostgrestTransformBuilder=i.default;const s=n(Jr());te.PostgrestBuilder=s.default;const a=n(Hr());return te.PostgrestError=a.default,te.default={PostgrestClient:t.default,PostgrestQueryBuilder:e.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:s.default,PostgrestError:a.default},te}var cs=ls();const us=Xi(cs),{PostgrestClient:ds,PostgrestQueryBuilder:ho,PostgrestFilterBuilder:fo,PostgrestTransformBuilder:mo,PostgrestBuilder:po,PostgrestError:go}=us,hs="2.11.2",fs={"X-Client-Info":`realtime-js/${hs}`},ms="1.0.0",Yr=1e4,ps=1e3;var We;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(We||(We={}));var de;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(de||(de={}));var fe;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(fe||(fe={}));var fn;(function(n){n.websocket="websocket"})(fn||(fn={}));var Ae;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Ae||(Ae={}));class gs{constructor(){this.HEADER_LENGTH=1}decode(t,e){return t.constructor===ArrayBuffer?e(this._binaryDecode(t)):e(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const e=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,e,r)}_decodeBroadcast(t,e,r){const i=e.getUint8(1),s=e.getUint8(2);let a=this.HEADER_LENGTH+2;const o=r.decode(t.slice(a,a+i));a=a+i;const l=r.decode(t.slice(a,a+s));a=a+s;const d=JSON.parse(r.decode(t.slice(a,t.byteLength)));return{ref:null,topic:o,event:l,payload:d}}}class Kr{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var W;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(W||(W={}));const lr=(n,t,e={})=>{var r;const i=(r=e.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((s,a)=>(s[a]=vs(a,n,t,i),s),{})},vs=(n,t,e,r)=>{const i=t.find(o=>o.name===n),s=i==null?void 0:i.type,a=e[n];return s&&!r.includes(s)?Vr(s,a):mn(a)},Vr=(n,t)=>{if(n.charAt(0)==="_"){const e=n.slice(1,n.length);return ws(t,e)}switch(n){case W.bool:return _s(t);case W.float4:case W.float8:case W.int2:case W.int4:case W.int8:case W.numeric:case W.oid:return ys(t);case W.json:case W.jsonb:return bs(t);case W.timestamp:return ks(t);case W.abstime:case W.date:case W.daterange:case W.int4range:case W.int8range:case W.money:case W.reltime:case W.text:case W.time:case W.timestamptz:case W.timetz:case W.tsrange:case W.tstzrange:return mn(t);default:return mn(t)}},mn=n=>n,_s=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},ys=n=>{if(typeof n=="string"){const t=parseFloat(n);if(!Number.isNaN(t))return t}return n},bs=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(t){return console.log(`JSON parse error: ${t}`),n}return n},ws=(n,t)=>{if(typeof n!="string")return n;const e=n.length-1,r=n[e];if(n[0]==="{"&&r==="}"){let s;const a=n.slice(1,e);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>Vr(t,o))}return n},ks=n=>typeof n=="string"?n.replace(" ","T"):n,Gr=n=>{let t=n;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Zt{constructor(t,e,r={},i=Yr){this.channel=t,this.event=e,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var r;return this._hasReceived(t)&&e((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var cr;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(cr||(cr={}));class st{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(e==null?void 0:e.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=st.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=st.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(r.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=st.syncDiff(this.state,i,s,a),o())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,r,i){const s=this.cloneDeep(t),a=this.transformState(e),o={},l={};return this.map(s,(d,u)=>{a[d]||(l[d]=u)}),this.map(a,(d,u)=>{const f=s[d];if(f){const g=u.map(x=>x.presence_ref),v=f.map(x=>x.presence_ref),k=u.filter(x=>v.indexOf(x.presence_ref)<0),b=f.filter(x=>g.indexOf(x.presence_ref)<0);k.length>0&&(o[d]=k),b.length>0&&(l[d]=b)}else o[d]=u}),this.syncDiff(s,{joins:o,leaves:l},r,i)}static syncDiff(t,e,r,i){const{joins:s,leaves:a}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(s,(o,l)=>{var d;const u=(d=t[o])!==null&&d!==void 0?d:[];if(t[o]=this.cloneDeep(l),u.length>0){const f=t[o].map(v=>v.presence_ref),g=u.filter(v=>f.indexOf(v.presence_ref)<0);t[o].unshift(...g)}r(o,u,l)}),this.map(a,(o,l)=>{let d=t[o];if(!d)return;const u=l.map(f=>f.presence_ref);d=d.filter(f=>u.indexOf(f.presence_ref)<0),t[o]=d,i(o,d,l),d.length===0&&delete t[o]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(r=>e(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,r)=>{const i=t[r];return"metas"in i?e[r]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):e[r]=i,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ur;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(ur||(ur={}));var dr;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(dr||(dr={}));var _e;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(_e||(_e={}));class Tn{constructor(t,e={config:{}},r){this.topic=t,this.params=e,this.socket=r,this.bindings={},this.state=de.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new Zt(this,fe.join,this.params,this.timeout),this.rejoinTimer=new Kr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=de.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=de.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=de.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=de.errored,this.rejoinTimer.scheduleTimeout())}),this._on(fe.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new st(this),this.broadcastEndpointURL=Gr(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,e=this.timeout){var r,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:a,private:o}}=this.params;this._onError(u=>t==null?void 0:t(_e.CHANNEL_ERROR,u)),this._onClose(()=>t==null?void 0:t(_e.CLOSED));const l={},d={broadcast:s,presence:a,postgres_changes:(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&i!==void 0?i:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:d},l)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",async({postgres_changes:u})=>{var f;if(this.socket.setAuth(),u===void 0){t==null||t(_e.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,v=(f=g==null?void 0:g.length)!==null&&f!==void 0?f:0,k=[];for(let b=0;b<v;b++){const x=g[b],{filter:{event:T,schema:y,table:I,filter:w}}=x,O=u&&u[b];if(O&&O.event===T&&O.schema===y&&O.table===I&&O.filter===w)k.push(Object.assign(Object.assign({},x),{id:O.id}));else{this.unsubscribe(),t==null||t(_e.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=k,t&&t(_e.SUBSCRIBED);return}}).receive("error",u=>{t==null||t(_e.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(_e.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,e={}){return await this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,e,r){return this._on(t,e,r)}async send(t,e={}){var r,i;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:a}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=e.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=d.body)===null||i===void 0?void 0:i.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const d=this._push(t.type,t,e.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),d.receive("ok",()=>s("ok")),d.receive("error",()=>s("error")),d.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=de.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(fe.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const i=new Zt(this,fe.leave,{},t);i.receive("ok",()=>{e(),r("ok")}).receive("timeout",()=>{e(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(t,e,r){const i=new AbortController,s=setTimeout(()=>i.abort(),r),a=await this.socket.fetch(t,Object.assign(Object.assign({},e),{signal:i.signal}));return clearTimeout(s),a}_push(t,e,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Zt(this,t,e,r);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(t,e,r){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,r){var i,s;const a=t.toLocaleLowerCase(),{close:o,error:l,leave:d,join:u}=fe;if(r&&[o,l,d,u].indexOf(a)>=0&&r!==this._joinRef())return;let g=this._onMessage(a,e,r);if(e&&!g)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(v=>{var k,b,x;return((k=v.filter)===null||k===void 0?void 0:k.event)==="*"||((x=(b=v.filter)===null||b===void 0?void 0:b.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===a}).map(v=>v.callback(g,r)):(s=this.bindings[a])===null||s===void 0||s.filter(v=>{var k,b,x,T,y,I;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in v){const w=v.id,O=(k=v.filter)===null||k===void 0?void 0:k.event;return w&&((b=e.ids)===null||b===void 0?void 0:b.includes(w))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((x=e.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const w=(y=(T=v==null?void 0:v.filter)===null||T===void 0?void 0:T.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return w==="*"||w===((I=e==null?void 0:e.event)===null||I===void 0?void 0:I.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===a}).map(v=>{if(typeof g=="object"&&"ids"in g){const k=g.data,{schema:b,table:x,commit_timestamp:T,type:y,errors:I}=k;g=Object.assign(Object.assign({},{schema:b,table:x,commit_timestamp:T,eventType:y,new:{},old:{},errors:I}),this._getPayloadRecords(k))}v.callback(g,r)})}_isClosed(){return this.state===de.closed}_isJoined(){return this.state===de.joined}_isJoining(){return this.state===de.joining}_isLeaving(){return this.state===de.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,r){const i=t.toLocaleLowerCase(),s={type:i,filter:e,callback:r};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,e){const r=t.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&Tn.isEqual(i.filter,e))}),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(fe.close,{},t)}_onError(t){this._on(fe.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=de.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const e={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(e.new=lr(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(e.old=lr(t.columns,t.old_record)),e}}const xs=()=>{},Cs=typeof WebSocket<"u",Ds=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Ss{constructor(t,e){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=fs,this.params={},this.timeout=Yr,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=xs,this.conn=null,this.sendBuffer=[],this.serializer=new gs,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...o)=>Ze(async()=>{const{default:l}=await Promise.resolve().then(()=>Qe);return{default:l}},void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${t}/${fn.websocket}`,this.httpEndpoint=Gr(t),e!=null&&e.transport?this.transport=e.transport:this.transport=null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.headers&&(this.headers=Object.assign(Object.assign({},this.headers),e.headers)),e!=null&&e.timeout&&(this.timeout=e.timeout),e!=null&&e.logger&&(this.logger=e.logger),e!=null&&e.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs);const i=(r=e==null?void 0:e.params)===null||r===void 0?void 0:r.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=e!=null&&e.reconnectAfterMs?e.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=e!=null&&e.encode?e.encode:(s,a)=>a(JSON.stringify(s)),this.decode=e!=null&&e.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Kr(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(e==null?void 0:e.fetch),e!=null&&e.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(e==null?void 0:e.worker)||!1,this.workerUrl=e==null?void 0:e.workerUrl}this.accessToken=(e==null?void 0:e.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(Cs){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Es(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Ze(async()=>{const{default:t}=await import("./browser-BbrJjJso.js").then(e=>e.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ms}))}disconnect(t,e){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,e??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const e=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),e}async removeAllChannels(){const t=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),t}log(t,e,r){this.logger(t,e,r)}connectionState(){switch(this.conn&&this.conn.readyState){case We.connecting:return Ae.Connecting;case We.open:return Ae.Open;case We.closing:return Ae.Closing;default:return Ae.Closed}}isConnected(){return this.connectionState()===Ae.Open}channel(t,e={config:{}}){const r=new Tn(`realtime:${t}`,e,this);return this.channels.push(r),r}push(t){const{topic:e,event:r,payload:i,ref:s}=t,a=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${e} ${r} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){let e=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(e){let r=null;try{r=JSON.parse(atob(e.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=e,this.channels.forEach(i=>{e&&i.updateJoinPayload({access_token:e}),i.joinedOnce&&i._isJoined()&&i._push(fe.access_token,{access_token:e})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(ps,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,e=>{let{topic:r,event:i,payload:s,ref:a}=e;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${r} ${i} ${a&&"("+a+")"||""}`,s),this.channels.filter(o=>o._isMember(r)).forEach(o=>o._trigger(i,s,a)),this.stateChangeCallbacks.message.forEach(o=>o(e))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(fe.error))}_appendParams(t,e){if(Object.keys(e).length===0)return t;const r=t.match(/\?/)?"&":"?",i=new URLSearchParams(e);return`${t}${r}${i}`}_workerObjectUrl(t){let e;if(t)e=t;else{const r=new Blob([Ds],{type:"application/javascript"});e=URL.createObjectURL(r)}return e}}class Es{constructor(t,e,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=We.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=r.close}}class In extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ne(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class Ts extends In{constructor(t,e){super(t),this.name="StorageApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class pn extends In{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}}var Is=function(n,t,e,r){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(u){try{d(r.next(u))}catch(f){a(f)}}function l(u){try{d(r.throw(u))}catch(f){a(f)}}function d(u){u.done?s(u.value):i(u.value).then(o,l)}d((r=r.apply(n,t||[])).next())})};const Zr=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...e)=>Ze(async()=>{const{default:r}=await Promise.resolve().then(()=>Qe);return{default:r}},void 0).then(({default:r})=>r(...e)):t=fetch,(...e)=>t(...e)},As=()=>Is(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ze(()=>Promise.resolve().then(()=>Qe),void 0)).Response:Response}),gn=n=>{if(Array.isArray(n))return n.map(e=>gn(e));if(typeof n=="function"||n!==Object(n))return n;const t={};return Object.entries(n).forEach(([e,r])=>{const i=e.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=gn(r)}),t};var Ne=function(n,t,e,r){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(u){try{d(r.next(u))}catch(f){a(f)}}function l(u){try{d(r.throw(u))}catch(f){a(f)}}function d(u){u.done?s(u.value):i(u.value).then(o,l)}d((r=r.apply(n,t||[])).next())})};const Xt=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Os=(n,t,e)=>Ne(void 0,void 0,void 0,function*(){const r=yield As();n instanceof r&&!(e!=null&&e.noResolveJson)?n.json().then(i=>{t(new Ts(Xt(i),n.status||500))}).catch(i=>{t(new pn(Xt(i),i))}):t(new pn(Xt(n),n))}),Ns=(n,t,e,r)=>{const i={method:n,headers:(t==null?void 0:t.headers)||{}};return n==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r&&(i.body=JSON.stringify(r)),Object.assign(Object.assign({},i),e))};function ft(n,t,e,r,i,s){return Ne(this,void 0,void 0,function*(){return new Promise((a,o)=>{n(e,Ns(t,r,i,s)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>Os(l,o,r))})})}function Rt(n,t,e,r){return Ne(this,void 0,void 0,function*(){return ft(n,"GET",t,e,r)})}function ke(n,t,e,r,i){return Ne(this,void 0,void 0,function*(){return ft(n,"POST",t,r,i,e)})}function Ms(n,t,e,r,i){return Ne(this,void 0,void 0,function*(){return ft(n,"PUT",t,r,i,e)})}function js(n,t,e,r){return Ne(this,void 0,void 0,function*(){return ft(n,"HEAD",t,Object.assign(Object.assign({},e),{noResolveJson:!0}),r)})}function Xr(n,t,e,r,i){return Ne(this,void 0,void 0,function*(){return ft(n,"DELETE",t,r,i,e)})}var ae=function(n,t,e,r){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(u){try{d(r.next(u))}catch(f){a(f)}}function l(u){try{d(r.throw(u))}catch(f){a(f)}}function d(u){u.done?s(u.value):i(u.value).then(o,l)}d((r=r.apply(n,t||[])).next())})};const Ps={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},hr={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class $s{constructor(t,e={},r,i){this.url=t,this.headers=e,this.bucketId=r,this.fetch=Zr(i)}uploadOrUpdate(t,e,r,i){return ae(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},hr),i);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=r,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(o=Object.assign(Object.assign({},o),i.headers));const d=this._removeEmptyFolders(e),u=this._getFinalPath(d),f=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:s,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),g=yield f.json();return f.ok?{data:{path:d,id:g.Id,fullPath:g.Key},error:null}:{data:null,error:g}}catch(s){if(ne(s))return{data:null,error:s};throw s}})}upload(t,e,r){return ae(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,e,r)})}uploadToSignedUrl(t,e,r,i){return ae(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),a=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",e);try{let l;const d=Object.assign({upsert:hr.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",d.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",d.cacheControl)):(l=r,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const f=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u}),g=yield f.json();return f.ok?{data:{path:s,fullPath:g.Key},error:null}:{data:null,error:g}}catch(l){if(ne(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,e){return ae(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t);const i=Object.assign({},this.headers);e!=null&&e.upsert&&(i["x-upsert"]="true");const s=yield ke(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),a=new URL(this.url+s.url),o=a.searchParams.get("token");if(!o)throw new In("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:o},error:null}}catch(r){if(ne(r))return{data:null,error:r};throw r}})}update(t,e,r){return ae(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,e,r)})}move(t,e,r){return ae(this,void 0,void 0,function*(){try{return{data:yield ke(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(ne(i))return{data:null,error:i};throw i}})}copy(t,e,r){return ae(this,void 0,void 0,function*(){try{return{data:{path:(yield ke(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(ne(i))return{data:null,error:i};throw i}})}createSignedUrl(t,e,r){return ae(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),s=yield ke(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:e},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(ne(i))return{data:null,error:i};throw i}})}createSignedUrls(t,e,r){return ae(this,void 0,void 0,function*(){try{const i=yield ke(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:t},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(ne(i))return{data:null,error:i};throw i}})}download(t,e){return ae(this,void 0,void 0,function*(){const i=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),a=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield Rt(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(ne(o))return{data:null,error:o};throw o}})}info(t){return ae(this,void 0,void 0,function*(){const e=this._getFinalPath(t);try{const r=yield Rt(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:gn(r),error:null}}catch(r){if(ne(r))return{data:null,error:r};throw r}})}exists(t){return ae(this,void 0,void 0,function*(){const e=this._getFinalPath(t);try{return yield js(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(ne(r)&&r instanceof pn){const i=r.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:r}}throw r}})}getPublicUrl(t,e){const r=this._getFinalPath(t),i=[],s=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&i.push(s);const o=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});l!==""&&i.push(l);let d=i.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${r}${d}`)}}}remove(t){return ae(this,void 0,void 0,function*(){try{return{data:yield Xr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(e){if(ne(e))return{data:null,error:e};throw e}})}list(t,e,r){return ae(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Ps),e),{prefix:t||""});return{data:yield ke(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(ne(i))return{data:null,error:i};throw i}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}}const Fs="2.7.1",Rs={"X-Client-Info":`storage-js/${Fs}`};var Be=function(n,t,e,r){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(u){try{d(r.next(u))}catch(f){a(f)}}function l(u){try{d(r.throw(u))}catch(f){a(f)}}function d(u){u.done?s(u.value):i(u.value).then(o,l)}d((r=r.apply(n,t||[])).next())})};class Ls{constructor(t,e={},r){this.url=t,this.headers=Object.assign(Object.assign({},Rs),e),this.fetch=Zr(r)}listBuckets(){return Be(this,void 0,void 0,function*(){try{return{data:yield Rt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(ne(t))return{data:null,error:t};throw t}})}getBucket(t){return Be(this,void 0,void 0,function*(){try{return{data:yield Rt(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(e){if(ne(e))return{data:null,error:e};throw e}})}createBucket(t,e={public:!1}){return Be(this,void 0,void 0,function*(){try{return{data:yield ke(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(ne(r))return{data:null,error:r};throw r}})}updateBucket(t,e){return Be(this,void 0,void 0,function*(){try{return{data:yield Ms(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(ne(r))return{data:null,error:r};throw r}})}emptyBucket(t){return Be(this,void 0,void 0,function*(){try{return{data:yield ke(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(ne(e))return{data:null,error:e};throw e}})}deleteBucket(t){return Be(this,void 0,void 0,function*(){try{return{data:yield Xr(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(ne(e))return{data:null,error:e};throw e}})}}class Us extends Ls{constructor(t,e={},r){super(t,e,r)}from(t){return new $s(this.url,this.headers,t,this.fetch)}}const zs="2.49.3";let rt="";typeof Deno<"u"?rt="deno":typeof document<"u"?rt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?rt="react-native":rt="node";const Bs={"X-Client-Info":`supabase-js-${rt}/${zs}`},Hs={headers:Bs},Js={schema:"public"},qs={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ws={};var Ys=function(n,t,e,r){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(u){try{d(r.next(u))}catch(f){a(f)}}function l(u){try{d(r.throw(u))}catch(f){a(f)}}function d(u){u.done?s(u.value):i(u.value).then(o,l)}d((r=r.apply(n,t||[])).next())})};const Ks=n=>{let t;return n?t=n:typeof fetch>"u"?t=zr:t=fetch,(...e)=>t(...e)},Vs=()=>typeof Headers>"u"?Br:Headers,Gs=(n,t,e)=>{const r=Ks(e),i=Vs();return(s,a)=>Ys(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:n;let d=new i(a==null?void 0:a.headers);return d.has("apikey")||d.set("apikey",n),d.has("Authorization")||d.set("Authorization",`Bearer ${l}`),r(s,Object.assign(Object.assign({},a),{headers:d}))})};var Zs=function(n,t,e,r){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(u){try{d(r.next(u))}catch(f){a(f)}}function l(u){try{d(r.throw(u))}catch(f){a(f)}}function d(u){u.done?s(u.value):i(u.value).then(o,l)}d((r=r.apply(n,t||[])).next())})};function Xs(n){return n.replace(/\/$/,"")}function Qs(n,t){const{db:e,auth:r,realtime:i,global:s}=n,{db:a,auth:o,realtime:l,global:d}=t,u={db:Object.assign(Object.assign({},a),e),auth:Object.assign(Object.assign({},o),r),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},d),s),accessToken:()=>Zs(this,void 0,void 0,function*(){return""})};return n.accessToken?u.accessToken=n.accessToken:delete u.accessToken,u}const Qr="2.69.1",qe=30*1e3,vn=3,Qt=vn*qe,ea="http://localhost:9999",ta="supabase.auth.token",na={"X-Client-Info":`gotrue-js/${Qr}`},_n="X-Supabase-Api-Version",ei={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ra=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,ia=6e5;class An extends Error{constructor(t,e,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=r}}function j(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class sa extends An{constructor(t,e,r){super(t,e,r),this.name="AuthApiError",this.status=e,this.code=r}}function aa(n){return j(n)&&n.name==="AuthApiError"}class ti extends An{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}}class Ce extends An{constructor(t,e,r,i){super(t,r,i),this.name=e,this.status=r}}class be extends Ce{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function oa(n){return j(n)&&n.name==="AuthSessionMissingError"}class en extends Ce{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class St extends Ce{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Et extends Ce{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function la(n){return j(n)&&n.name==="AuthImplicitGrantRedirectError"}class fr extends Ce{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class yn extends Ce{constructor(t,e){super(t,"AuthRetryableFetchError",e,void 0)}}function tn(n){return j(n)&&n.name==="AuthRetryableFetchError"}class mr extends Ce{constructor(t,e,r){super(t,"AuthWeakPasswordError",e,"weak_password"),this.reasons=r}}class at extends Ce{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const pr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),gr=` 	
\r=`.split(""),ca=(()=>{const n=new Array(128);for(let t=0;t<n.length;t+=1)n[t]=-1;for(let t=0;t<gr.length;t+=1)n[gr[t].charCodeAt(0)]=-2;for(let t=0;t<pr.length;t+=1)n[pr[t].charCodeAt(0)]=t;return n})();function ni(n,t,e){const r=ca[n];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)e(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function vr(n){const t=[],e=a=>{t.push(String.fromCodePoint(a))},r={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{ha(a,r,e)};for(let a=0;a<n.length;a+=1)ni(n.charCodeAt(a),i,s);return t.join("")}function ua(n,t){if(n<=127){t(n);return}else if(n<=2047){t(192|n>>6),t(128|n&63);return}else if(n<=65535){t(224|n>>12),t(128|n>>6&63),t(128|n&63);return}else if(n<=1114111){t(240|n>>18),t(128|n>>12&63),t(128|n>>6&63),t(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function da(n,t){for(let e=0;e<n.length;e+=1){let r=n.charCodeAt(e);if(r>55295&&r<=56319){const i=(r-55296)*1024&65535;r=(n.charCodeAt(e+1)-56320&65535|i)+65536,e+=1}ua(r,t)}}function ha(n,t,e){if(t.utf8seq===0){if(n<=127){e(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){t.utf8seq=r;break}if(t.utf8seq===2)t.codepoint=n&31;else if(t.utf8seq===3)t.codepoint=n&15;else if(t.utf8seq===4)t.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|n&63,t.utf8seq-=1,t.utf8seq===0&&e(t.codepoint)}}function fa(n){const t=[],e={queue:0,queuedBits:0},r=i=>{t.push(i)};for(let i=0;i<n.length;i+=1)ni(n.charCodeAt(i),e,r);return new Uint8Array(t)}function ma(n){const t=[];return da(n,e=>t.push(e)),new Uint8Array(t)}function pa(n){return Math.round(Date.now()/1e3)+n}function ga(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const t=Math.random()*16|0;return(n=="x"?t:t&3|8).toString(16)})}const pe=()=>typeof window<"u"&&typeof document<"u",Ee={tested:!1,writable:!1},ot=()=>{if(!pe())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ee.tested)return Ee.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Ee.tested=!0,Ee.writable=!0}catch{Ee.tested=!0,Ee.writable=!1}return Ee.writable};function va(n){const t={},e=new URL(n);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return e.searchParams.forEach((r,i)=>{t[i]=r}),t}const ri=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...e)=>Ze(async()=>{const{default:r}=await Promise.resolve().then(()=>Qe);return{default:r}},void 0).then(({default:r})=>r(...e)):t=fetch,(...e)=>t(...e)},_a=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",ii=async(n,t,e)=>{await n.setItem(t,JSON.stringify(e))},Tt=async(n,t)=>{const e=await n.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch{return e}},It=async(n,t)=>{await n.removeItem(t)};class Ht{constructor(){this.promise=new Ht.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}}Ht.promiseConstructor=Promise;function nn(n){const t=n.split(".");if(t.length!==3)throw new at("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!ra.test(t[r]))throw new at("JWT not in base64url format");return{header:JSON.parse(vr(t[0])),payload:JSON.parse(vr(t[1])),signature:fa(t[2]),raw:{header:t[0],payload:t[1]}}}async function ya(n){return await new Promise(t=>{setTimeout(()=>t(null),n)})}function ba(n,t){return new Promise((r,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await n(s);if(!t(s,null,a)){r(a);return}}catch(a){if(!t(s,a)){i(a);return}}})()})}function wa(n){return("0"+n.toString(16)).substr(-2)}function ka(){const t=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=e.length;let i="";for(let s=0;s<56;s++)i+=e.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(t),Array.from(t,wa).join("")}async function xa(n){const e=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",e),i=new Uint8Array(r);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function Ca(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const e=await xa(n);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function He(n,t,e=!1){const r=ka();let i=r;e&&(i+="/PASSWORD_RECOVERY"),await ii(n,`${t}-code-verifier`,i);const s=await Ca(r);return[s,r===s?"plain":"s256"]}const Da=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Sa(n){const t=n.headers.get(_n);if(!t||!t.match(Da))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Ea(n){if(!n)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(n<=t)throw new Error("JWT has expired")}function Ta(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var Ia=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};const Te=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Aa=[502,503,504];async function _r(n){var t;if(!_a(n))throw new yn(Te(n),0);if(Aa.includes(n.status))throw new yn(Te(n),n.status);let e;try{e=await n.json()}catch(s){throw new ti(Te(s),s)}let r;const i=Sa(n);if(i&&i.getTime()>=ei["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?r=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(r=e.error_code),r){if(r==="weak_password")throw new mr(Te(e),n.status,((t=e.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new be}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new mr(Te(e),n.status,e.weak_password.reasons);throw new sa(Te(e),n.status||500,r)}const Oa=(n,t,e,r)=>{const i={method:n,headers:(t==null?void 0:t.headers)||{}};return n==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),e))};async function L(n,t,e,r){var i;const s=Object.assign({},r==null?void 0:r.headers);s[_n]||(s[_n]=ei["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const a=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(a.redirect_to=r.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await Na(n,t,e+o,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function Na(n,t,e,r,i,s){const a=Oa(t,r,i,s);let o;try{o=await n(e,Object.assign({},a))}catch(l){throw console.error(l),new yn(Te(l),0)}if(o.ok||await _r(o),r!=null&&r.noResolveJson)return o;try{return await o.json()}catch(l){await _r(l)}}function we(n){var t;let e=null;$a(n)&&(e=Object.assign({},n),n.expires_at||(e.expires_at=pa(n.expires_in)));const r=(t=n.user)!==null&&t!==void 0?t:n;return{data:{session:e,user:r},error:null}}function yr(n){const t=we(n);return!t.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((e,r)=>e&&typeof r=="string",!0)&&(t.data.weak_password=n.weak_password),t}function xe(n){var t;return{data:{user:(t=n.user)!==null&&t!==void 0?t:n},error:null}}function Ma(n){return{data:n,error:null}}function ja(n){const{action_link:t,email_otp:e,hashed_token:r,redirect_to:i,verification_type:s}=n,a=Ia(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:e,hashed_token:r,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function Pa(n){return n}function $a(n){return n.access_token&&n.refresh_token&&n.expires_in}var Fa=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};class Ra{constructor({url:t="",headers:e={},fetch:r}){this.url=t,this.headers=e,this.fetch=ri(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,e="global"){try{return await L(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(j(r))return{data:null,error:r};throw r}}async inviteUserByEmail(t,e={}){try{return await L(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:xe})}catch(r){if(j(r))return{data:{user:null},error:r};throw r}}async generateLink(t){try{const{options:e}=t,r=Fa(t,["options"]),i=Object.assign(Object.assign({},r),e);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),await L(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:ja,redirectTo:e==null?void 0:e.redirectTo})}catch(e){if(j(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(t){try{return await L(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:xe})}catch(e){if(j(e))return{data:{user:null},error:e};throw e}}async listUsers(t){var e,r,i,s,a,o,l;try{const d={nextPage:null,lastPage:0,total:0},u=await L(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(e=t==null?void 0:t.page)===null||e===void 0?void 0:e.toString())!==null&&r!==void 0?r:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:Pa});if(u.error)throw u.error;const f=await u.json(),g=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,v=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return v.length>0&&(v.forEach(k=>{const b=parseInt(k.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(k.split(";")[1].split("=")[1]);d[`${x}Page`]=b}),d.total=parseInt(g)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(j(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){try{return await L(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:xe})}catch(e){if(j(e))return{data:{user:null},error:e};throw e}}async updateUserById(t,e){try{return await L(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:xe})}catch(r){if(j(r))return{data:{user:null},error:r};throw r}}async deleteUser(t,e=!1){try{return await L(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:xe})}catch(r){if(j(r))return{data:{user:null},error:r};throw r}}async _listFactors(t){try{const{data:e,error:r}=await L(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:e,error:r}}catch(e){if(j(e))return{data:null,error:e};throw e}}async _deleteFactor(t){try{return{data:await L(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(j(e))return{data:null,error:e};throw e}}}const La={getItem:n=>ot()?globalThis.localStorage.getItem(n):null,setItem:(n,t)=>{ot()&&globalThis.localStorage.setItem(n,t)},removeItem:n=>{ot()&&globalThis.localStorage.removeItem(n)}};function br(n={}){return{getItem:t=>n[t]||null,setItem:(t,e)=>{n[t]=e},removeItem:t=>{delete n[t]}}}function Ua(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Je={debug:!!(globalThis&&ot()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class si extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class za extends si{}async function Ba(n,t,e){Je.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),Je.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){Je.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,i.name);try{return await e()}finally{Je.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,i.name)}}else{if(t===0)throw Je.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new za(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Je.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await e()}}))}Ua();const Ha={url:ea,storageKey:ta,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:na,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function wr(n,t,e){return await e()}class dt{constructor(t){var e,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=dt.nextInstanceID,dt.nextInstanceID+=1,this.instanceID>0&&pe()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},Ha),t);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Ra({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=ri(i.fetch),this.lock=i.lock||wr,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:pe()&&(!((e=globalThis==null?void 0:globalThis.navigator)===null||e===void 0)&&e.locks)?this.lock=Ba:this.lock=wr,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:ot()?this.storage=La:(this.memoryStorage={},this.storage=br(this.memoryStorage)):(this.memoryStorage={},this.storage=br(this.memoryStorage)),pe()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Qr}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const e=va(window.location.href);let r="none";if(this._isImplicitGrantCallback(e)?r="implicit":await this._isPKCECallback(e)&&(r="pkce"),pe()&&this.detectSessionInUrl&&r!=="none"){const{data:i,error:s}=await this._getSessionFromURL(e,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),la(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return j(e)?{error:e}:{error:new ti("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var e,r,i;try{const s=await L(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(e=t==null?void 0:t.options)===null||e===void 0?void 0:e.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:we}),{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(s){if(j(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var e,r,i;try{let s;if("email"in t){const{email:u,password:f,options:g}=t;let v=null,k=null;this.flowType==="pkce"&&([v,k]=await He(this.storage,this.storageKey)),s=await L(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:g==null?void 0:g.emailRedirectTo,body:{email:u,password:f,data:(e=g==null?void 0:g.data)!==null&&e!==void 0?e:{},gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:v,code_challenge_method:k},xform:we})}else if("phone"in t){const{phone:u,password:f,options:g}=t;s=await L(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(r=g==null?void 0:g.data)!==null&&r!==void 0?r:{},channel:(i=g==null?void 0:g.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:we})}else throw new St("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(s){if(j(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let e;if("email"in t){const{email:s,password:a,options:o}=t;e=await L(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:yr})}else if("phone"in t){const{phone:s,password:a,options:o}=t;e=await L(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:yr})}else throw new St("You must provide either an email or phone number and a password");const{data:r,error:i}=e;return i?{data:{user:null,session:null},error:i}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new en}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(e){if(j(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(t){var e,r,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(e=t.options)===null||e===void 0?void 0:e.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const e=await Tt(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(e??"").split("/");try{const{data:s,error:a}=await L(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:we});if(await It(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new en}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(j(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:e,provider:r,token:i,access_token:s,nonce:a}=t,o=await L(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:e==null?void 0:e.captchaToken}},xform:we}),{data:l,error:d}=o;return d?{data:{user:null,session:null},error:d}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new en}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:d})}catch(e){if(j(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(t){var e,r,i,s,a;try{if("email"in t){const{email:o,options:l}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await He(this.storage,this.storageKey));const{error:f}=await L(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(e=l==null?void 0:l.data)!==null&&e!==void 0?e:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:o,options:l}=t,{data:d,error:u}=await L(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new St("You must provide either an email or phone number.")}catch(o){if(j(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var e,r;try{let i,s;"options"in t&&(i=(e=t.options)===null||e===void 0?void 0:e.redirectTo,s=(r=t.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:o}=await L(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:we});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,d=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(i){if(j(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(t){var e,r,i;try{let s=null,a=null;return this.flowType==="pkce"&&([s,a]=await He(this.storage,this.storageKey)),await L(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(e=t.options)===null||e===void 0?void 0:e.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:Ma})}catch(s){if(j(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:e},error:r}=t;if(r)throw r;if(!e)throw new be;const{error:i}=await L(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return{data:{user:null,session:null},error:i}})}catch(t){if(j(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const e=`${this.url}/resend`;if("email"in t){const{email:r,type:i,options:s}=t,{error:a}=await L(this.fetch,"POST",e,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in t){const{phone:r,type:i,options:s}=t,{data:a,error:o}=await L(this.fetch,"POST",e,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new St("You must provide either an email or phone number and a type")}catch(e){if(j(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(t,e){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await e()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=e();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const e=await this.__loadSession();return await t(e)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const e=await Tt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",e),e!==null&&(this._isValidSession(e)?t=e:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const r=t.expires_at?t.expires_at*1e3-Date.now()<Qt:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.storage.isServer){let a=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,d,u)=>(!a&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,d,u))})}return{data:{session:t},error:null}}const{session:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await L(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:xe}):await this._useSession(async e=>{var r,i,s;const{data:a,error:o}=e;if(o)throw o;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new be}:await L(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:xe})})}catch(e){if(j(e))return oa(e)&&(await this._removeSession(),await It(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(t,e={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,e))}async _updateUser(t,e={}){try{return await this._useSession(async r=>{const{data:i,error:s}=r;if(s)throw s;if(!i.session)throw new be;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await He(this.storage,this.storageKey));const{data:d,error:u}=await L(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:e==null?void 0:e.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:xe});if(u)throw u;return a.user=d.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(r){if(j(r))return{data:{user:null},error:r};throw r}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new be;const e=Date.now()/1e3;let r=e,i=!0,s=null;const{payload:a}=nn(t.access_token);if(a.exp&&(r=a.exp,i=r<=e),i){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:r-e,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(e){if(j(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async e=>{var r;if(!t){const{data:a,error:o}=e;if(o)throw o;t=(r=a.session)!==null&&r!==void 0?r:void 0}if(!(t!=null&&t.refresh_token))throw new be;const{session:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(j(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(t,e){try{if(!pe())throw new Et("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Et(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(e){case"implicit":if(this.flowType==="pkce")throw new fr("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Et("Not a valid implicit grant flow url.");break;default:}if(e==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new fr("No code detected.");const{data:y,error:I}=await this._exchangeCodeForSession(t.code);if(I)throw I;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:d}=t;if(!s||!o||!a||!d)throw new Et("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let g=u+f;l&&(g=parseInt(l));const v=g-u;v*1e3<=qe&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${f}s`);const k=g-f;u-k>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",k,g,u):u-k<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",k,g,u);const{data:b,error:x}=await this._getUser(s);if(x)throw x;const T={provider_token:r,provider_refresh_token:i,access_token:s,expires_in:f,expires_at:g,refresh_token:a,token_type:d,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:T,redirectType:t.type},error:null}}catch(r){if(j(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const e=await Tt(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&e)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async e=>{var r;const{data:i,error:s}=e;if(s)return{error:s};const a=(r=i.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:o}=await this.admin.signOut(a,t);if(o&&!(aa(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await It(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const e=ga(),r={id:e,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",e),this.stateChangeEmitters.delete(e)}};return this._debug("#onAuthStateChange()","registered callback with id",e),this.stateChangeEmitters.set(e,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(e)})))(),{data:{subscription:r}}}async _emitInitialSession(t){return await this._useSession(async e=>{var r,i;try{const{data:{session:s},error:a}=e;if(a)throw a;await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,e={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await He(this.storage,this.storageKey,!0));try{return await L(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(s){if(j(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:e,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(t=e.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(e){if(j(e))return{data:null,error:e};throw e}}async linkIdentity(t){var e;try{const{data:r,error:i}=await this._useSession(async s=>{var a,o,l,d,u;const{data:f,error:g}=s;if(g)throw g;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await L(this.fetch,"GET",v,{headers:this.headers,jwt:(u=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return pe()&&!(!((e=t.options)===null||e===void 0)&&e.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:t.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(j(r))return{data:{provider:t.provider,url:null},error:r};throw r}}async unlinkIdentity(t){try{return await this._useSession(async e=>{var r,i;const{data:s,error:a}=e;if(a)throw a;return await L(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(e){if(j(e))return{data:null,error:e};throw e}}async _refreshAccessToken(t){const e=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(e,"begin");try{const r=Date.now();return await ba(async i=>(i>0&&await ya(200*Math.pow(2,i-1)),this._debug(e,"refreshing attempt",i),await L(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:we})),(i,s)=>{const a=200*Math.pow(2,i);return s&&tn(s)&&Date.now()+a-r<qe})}catch(r){if(this._debug(e,"error",r),j(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(e,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,e){const r=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",e,"url",r),pe()&&!e.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}}async _recoverAndRefresh(){var t;const e="#_recoverAndRefresh()";this._debug(e,"begin");try{const r=await Tt(this.storage,this.storageKey);if(this._debug(e,"session from storage",r),!this._isValidSession(r)){this._debug(e,"session is not valid"),r!==null&&await this._removeSession();return}const i=((t=r.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Qt;if(this._debug(e,`session has${i?"":" not"} expired with margin of ${Qt}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:s}=await this._callRefreshToken(r.refresh_token);s&&(console.error(s),tn(s)||(this._debug(e,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(e,"error",r),console.error(r);return}finally{this._debug(e,"end")}}async _callRefreshToken(t){var e,r;if(!t)throw new be;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Ht;const{data:s,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!s.session)throw new be;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),j(s)){const a={session:null,error:s};return tn(s)||await this._removeSession(),(e=this.refreshingDeferred)===null||e===void 0||e.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,e,r=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",e,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:e});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,e)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await ii(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await It(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&pe()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),qe);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:r}}=e;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-t)/qe);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${qe}ms, refresh threshold is ${vn} ticks`),i<=vn&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof si)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!pe()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const e=`#_onVisibilityChanged(${t})`;this._debug(e,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(e,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,e,r){const i=[`provider=${encodeURIComponent(e)}`];if(r!=null&&r.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,a]=await He(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);i.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async e=>{var r;const{data:i,error:s}=e;return s?{data:null,error:s}:await L(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(e){if(j(e))return{data:null,error:e};throw e}}async _enroll(t){try{return await this._useSession(async e=>{var r,i;const{data:s,error:a}=e;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:d}=await L(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(e){if(j(e))return{data:null,error:e};throw e}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var r;const{data:i,error:s}=e;if(s)return{data:null,error:s};const{data:a,error:o}=await L(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(e){if(j(e))return{data:null,error:e};throw e}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var r;const{data:i,error:s}=e;return s?{data:null,error:s}:await L(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(e){if(j(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(t){const{data:e,error:r}=await this._challenge({factorId:t.factorId});return r?{data:null,error:r}:await this._verify({factorId:t.factorId,challengeId:e.id,code:t.code})}async _listFactors(){const{data:{user:t},error:e}=await this.getUser();if(e)return{data:null,error:e};const r=(t==null?void 0:t.factors)||[],i=r.filter(a=>a.factor_type==="totp"&&a.status==="verified"),s=r.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:r,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var e,r;const{data:{session:i},error:s}=t;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=nn(i.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((r=(e=i.user.factors)===null||e===void 0?void 0:e.filter(f=>f.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,e={keys:[]}){let r=e.keys.find(a=>a.kid===t);if(r||(r=this.jwks.keys.find(a=>a.kid===t),r&&this.jwks_cached_at+ia>Date.now()))return r;const{data:i,error:s}=await L(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!i.keys||i.keys.length===0)throw new at("JWKS is empty");if(this.jwks=i,this.jwks_cached_at=Date.now(),r=i.keys.find(a=>a.kid===t),!r)throw new at("No matching signing key found in JWKS");return r}async getClaims(t,e={keys:[]}){try{let r=t;if(!r){const{data:v,error:k}=await this.getSession();if(k||!v.session)return{data:null,error:k};r=v.session.access_token}const{header:i,payload:s,signature:a,raw:{header:o,payload:l}}=nn(r);if(Ea(s.exp),!i.kid||i.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:v}=await this.getUser(r);if(v)throw v;return{data:{claims:s,header:i,signature:a},error:null}}const d=Ta(i.alg),u=await this.fetchJwk(i.kid,e),f=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,a,ma(`${o}.${l}`)))throw new at("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(r){if(j(r))return{data:null,error:r};throw r}}}dt.nextInstanceID=0;const Ja=dt;class qa extends Ja{constructor(t){super(t)}}var Wa=function(n,t,e,r){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function o(u){try{d(r.next(u))}catch(f){a(f)}}function l(u){try{d(r.throw(u))}catch(f){a(f)}}function d(u){u.done?s(u.value):i(u.value).then(o,l)}d((r=r.apply(n,t||[])).next())})};class Ya{constructor(t,e,r){var i,s,a;if(this.supabaseUrl=t,this.supabaseKey=e,!t)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");const o=Xs(t);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,d={db:Js,realtime:Ws,auth:Object.assign(Object.assign({},qs),{storageKey:l}),global:Hs},u=Qs(r??{},d);this.storageKey=(i=u.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=u.global.headers)!==null&&s!==void 0?s:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=u.auth)!==null&&a!==void 0?a:{},this.headers,u.global.fetch),this.fetch=Gs(e,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new ds(`${o}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new Zi(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Us(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},r={}){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,e;return Wa(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(e=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:i,storageKey:s,flowType:a,lock:o,debug:l},d,u){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new qa({url:this.authUrl,headers:Object.assign(Object.assign({},f),d),storageKey:s,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:i,flowType:a,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new Ss(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,r)=>{this._handleTokenChanged(e,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Ka=(n,t,e)=>new Ya(n,t,e),Va="https://kfosgimkfydlbranmqvv.supabase.co",Ga="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtmb3NnaW1rZnlkbGJyYW5tcXZ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE2NDAyMTEsImV4cCI6MjA1NzIxNjIxMX0.BDjsfyPBKQ3ofLw2N7dKypFzVWc0FFOQeqcmSOHKCiA",Pt=Ka(Va,Ga,{auth:{persistSession:!1}});function Za(){const[n,t]=F(!1),[e,r]=F(null);return m("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-b from-gray-50 to-gray-100 px-4",children:m("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-xl shadow-lg",children:[m("div",{className:"text-center",children:[m("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Stromabrechnung"}),m("p",{className:"mt-2 text-sm text-gray-600",children:"Bitte melden Sie sich mit Ihrem Microsoft-Konto an"})]}),e&&m("div",{className:"rounded-md bg-red-50 p-4 text-sm text-red-600",children:e}),m("button",{onClick:async()=>{try{t(!0),r(null);const{error:s}=await Pt.auth.signInWithOAuth({provider:"azure",options:{scopes:"email",redirectTo:window.location.origin}});if(s)throw s}catch(s){console.error("Authentication error:",s),r(s.message)}finally{t(!1)}},disabled:n,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-blue-300",children:n?m("div",{className:"flex items-center",children:[m("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[m("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),m("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Wird geladen..."]}):m("div",{className:"flex items-center",children:[m("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",fill:"currentColor",children:m("path",{d:"M11.5 2.75a.75.75 0 01.75-.75h10a.75.75 0 01.75.75v10a.75.75 0 01-.75.75h-10a.75.75 0 01-.75-.75v-10zm-8 0a.75.75 0 01.75-.75h4a.75.75 0 01.75.75v4a.75.75 0 01-.75.75h-4a.75.75 0 01-.75-.75v-4zm0 8a.75.75 0 01.75-.75h4a.75.75 0 01.75.75v4a.75.75 0 01-.75.75h-4a.75.75 0 01-.75-.75v-4zm8 0a.75.75 0 01.75-.75h4a.75.75 0 01.75.75v4a.75.75 0 01-.75.75h-4a.75.75 0 01-.75-.75v-4z"})}),"Mit Microsoft anmelden"]})})]})})}var rn=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],Ye={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:typeof window=="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:function(n){return typeof console<"u"&&console.warn(n)},getWeek:function(n){var t=new Date(n.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var e=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-e.getTime())/864e5-3+(e.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},ht={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(n){var t=n%100;if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},oe=function(n,t){return t===void 0&&(t=2),("000"+n).slice(t*-1)},he=function(n){return n===!0?1:0};function kr(n,t){var e;return function(){var r=this,i=arguments;clearTimeout(e),e=setTimeout(function(){return n.apply(r,i)},t)}}var sn=function(n){return n instanceof Array?n:[n]};function ie(n,t,e){if(e===!0)return n.classList.add(t);n.classList.remove(t)}function B(n,t,e){var r=window.document.createElement(n);return t=t||"",e=e||"",r.className=t,e!==void 0&&(r.textContent=e),r}function At(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function ai(n,t){if(t(n))return n;if(n.parentNode)return ai(n.parentNode,t)}function Ot(n,t){var e=B("div","numInputWrapper"),r=B("input","numInput "+n),i=B("span","arrowUp"),s=B("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1?r.type="number":(r.type="text",r.pattern="\\d*"),t!==void 0)for(var a in t)r.setAttribute(a,t[a]);return e.appendChild(r),e.appendChild(i),e.appendChild(s),e}function ce(n){try{if(typeof n.composedPath=="function"){var t=n.composedPath();return t[0]}return n.target}catch{return n.target}}var an=function(){},Lt=function(n,t,e){return e.months[t?"shorthand":"longhand"][n]},Xa={D:an,F:function(n,t,e){n.setMonth(e.months.longhand.indexOf(t))},G:function(n,t){n.setHours((n.getHours()>=12?12:0)+parseFloat(t))},H:function(n,t){n.setHours(parseFloat(t))},J:function(n,t){n.setDate(parseFloat(t))},K:function(n,t,e){n.setHours(n.getHours()%12+12*he(new RegExp(e.amPM[1],"i").test(t)))},M:function(n,t,e){n.setMonth(e.months.shorthand.indexOf(t))},S:function(n,t){n.setSeconds(parseFloat(t))},U:function(n,t){return new Date(parseFloat(t)*1e3)},W:function(n,t,e){var r=parseInt(t),i=new Date(n.getFullYear(),0,2+(r-1)*7,0,0,0,0);return i.setDate(i.getDate()-i.getDay()+e.firstDayOfWeek),i},Y:function(n,t){n.setFullYear(parseFloat(t))},Z:function(n,t){return new Date(t)},d:function(n,t){n.setDate(parseFloat(t))},h:function(n,t){n.setHours((n.getHours()>=12?12:0)+parseFloat(t))},i:function(n,t){n.setMinutes(parseFloat(t))},j:function(n,t){n.setDate(parseFloat(t))},l:an,m:function(n,t){n.setMonth(parseFloat(t)-1)},n:function(n,t){n.setMonth(parseFloat(t)-1)},s:function(n,t){n.setSeconds(parseFloat(t))},u:function(n,t){return new Date(parseFloat(t))},w:an,y:function(n,t){n.setFullYear(2e3+parseFloat(t))}},Oe={D:"",F:"",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},lt={Z:function(n){return n.toISOString()},D:function(n,t,e){return t.weekdays.shorthand[lt.w(n,t,e)]},F:function(n,t,e){return Lt(lt.n(n,t,e)-1,!1,t)},G:function(n,t,e){return oe(lt.h(n,t,e))},H:function(n){return oe(n.getHours())},J:function(n,t){return t.ordinal!==void 0?n.getDate()+t.ordinal(n.getDate()):n.getDate()},K:function(n,t){return t.amPM[he(n.getHours()>11)]},M:function(n,t){return Lt(n.getMonth(),!0,t)},S:function(n){return oe(n.getSeconds())},U:function(n){return n.getTime()/1e3},W:function(n,t,e){return e.getWeek(n)},Y:function(n){return oe(n.getFullYear(),4)},d:function(n){return oe(n.getDate())},h:function(n){return n.getHours()%12?n.getHours()%12:12},i:function(n){return oe(n.getMinutes())},j:function(n){return n.getDate()},l:function(n,t){return t.weekdays.longhand[n.getDay()]},m:function(n){return oe(n.getMonth()+1)},n:function(n){return n.getMonth()+1},s:function(n){return n.getSeconds()},u:function(n){return n.getTime()},w:function(n){return n.getDay()},y:function(n){return String(n.getFullYear()).substring(2)}},oi=function(n){var t=n.config,e=t===void 0?Ye:t,r=n.l10n,i=r===void 0?ht:r,s=n.isMobile,a=s===void 0?!1:s;return function(o,l,d){var u=d||i;return e.formatDate!==void 0&&!a?e.formatDate(o,l,u):l.split("").map(function(f,g,v){return lt[f]&&v[g-1]!=="\\"?lt[f](o,u,e):f!=="\\"?f:""}).join("")}},bn=function(n){var t=n.config,e=t===void 0?Ye:t,r=n.l10n,i=r===void 0?ht:r;return function(s,a,o,l){if(!(s!==0&&!s)){var d=l||i,u,f=s;if(s instanceof Date)u=new Date(s.getTime());else if(typeof s!="string"&&s.toFixed!==void 0)u=new Date(s);else if(typeof s=="string"){var g=a||(e||Ye).dateFormat,v=String(s).trim();if(v==="today")u=new Date,o=!0;else if(e&&e.parseDate)u=e.parseDate(s,g);else if(/Z$/.test(v)||/GMT$/.test(v))u=new Date(s);else{for(var k=void 0,b=[],x=0,T=0,y="";x<g.length;x++){var I=g[x],w=I==="\\",O=g[x-1]==="\\"||w;if(Oe[I]&&!O){y+=Oe[I];var R=new RegExp(y).exec(s);R&&(k=!0)&&b[I!=="Y"?"push":"unshift"]({fn:Xa[I],val:R[++T]})}else w||(y+=".")}u=!e||!e.noCalendar?new Date(new Date().getFullYear(),0,1,0,0,0,0):new Date(new Date().setHours(0,0,0,0)),b.forEach(function(Y){var H=Y.fn,U=Y.val;return u=H(u,U,d)||u}),u=k?u:void 0}}if(!(u instanceof Date&&!isNaN(u.getTime()))){e.errorHandler(new Error("Invalid date provided: "+f));return}return o===!0&&u.setHours(0,0,0,0),u}}};function ue(n,t,e){return e===void 0&&(e=!0),e!==!1?new Date(n.getTime()).setHours(0,0,0,0)-new Date(t.getTime()).setHours(0,0,0,0):n.getTime()-t.getTime()}var Qa=function(n,t,e){return n>Math.min(t,e)&&n<Math.max(t,e)},on=function(n,t,e){return n*3600+t*60+e},eo=function(n){var t=Math.floor(n/3600),e=(n-t*3600)/60;return[t,e,n-t*3600-e*60]},to={DAY:864e5};function ln(n){var t=n.defaultHour,e=n.defaultMinute,r=n.defaultSeconds;if(n.minDate!==void 0){var i=n.minDate.getHours(),s=n.minDate.getMinutes(),a=n.minDate.getSeconds();t<i&&(t=i),t===i&&e<s&&(e=s),t===i&&e===s&&r<a&&(r=n.minDate.getSeconds())}if(n.maxDate!==void 0){var o=n.maxDate.getHours(),l=n.maxDate.getMinutes();t=Math.min(t,o),t===o&&(e=Math.min(l,e)),t===o&&e===l&&(r=n.maxDate.getSeconds())}return{hours:t,minutes:e,seconds:r}}typeof Object.assign!="function"&&(Object.assign=function(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];if(!n)throw TypeError("Cannot convert undefined or null to object");for(var r=function(o){o&&Object.keys(o).forEach(function(l){return n[l]=o[l]})},i=0,s=t;i<s.length;i++){var a=s[i];r(a)}return n});var re=function(){return re=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},re.apply(this,arguments)},xr=function(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;for(var r=Array(n),i=0,t=0;t<e;t++)for(var s=arguments[t],a=0,o=s.length;a<o;a++,i++)r[i]=s[a];return r},no=300;function ro(n,t){var e={config:re(re({},Ye),Q.defaultConfig),l10n:ht};e.parseDate=bn({config:e.config,l10n:e.l10n}),e._handlers=[],e.pluginElements=[],e.loadedPlugins=[],e._bind=b,e._setHoursFromDate=g,e._positionCalendar=wt,e.changeMonth=Pe,e.changeYear=_t,e.clear=pt,e.close=gt,e.onMouseOver=bt,e._createElement=B,e.createDay=R,e.destroy=vt,e.isEnabled=Se,e.jumpToDate=y,e.updateValue=ve,e.open=di,e.redraw=Pn,e.set=pi,e.setDate=gi,e.toggle=bi;function r(){e.utils={getDaysInMonth:function(c,h){return c===void 0&&(c=e.currentMonth),h===void 0&&(h=e.currentYear),c===1&&(h%4===0&&h%100!==0||h%400===0)?29:e.l10n.daysInMonth[c]}}}function i(){e.element=e.input=n,e.isOpen=!1,hi(),jn(),_i(),vi(),r(),e.isMobile||O(),T(),(e.selectedDates.length||e.config.noCalendar)&&(e.config.enableTime&&g(e.config.noCalendar?e.latestSelectedDateObj:void 0),ve(!1)),o();var c=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!e.isMobile&&c&&wt(),V("onReady")}function s(){var c;return((c=e.calendarContainer)===null||c===void 0?void 0:c.getRootNode()).activeElement||document.activeElement}function a(c){return c.bind(e)}function o(){var c=e.config;c.weekNumbers===!1&&c.showMonths===1||c.noCalendar!==!0&&window.requestAnimationFrame(function(){if(e.calendarContainer!==void 0&&(e.calendarContainer.style.visibility="hidden",e.calendarContainer.style.display="block"),e.daysContainer!==void 0){var h=(e.days.offsetWidth+1)*c.showMonths;e.daysContainer.style.width=h+"px",e.calendarContainer.style.width=h+(e.weekWrapper!==void 0?e.weekWrapper.offsetWidth:0)+"px",e.calendarContainer.style.removeProperty("visibility"),e.calendarContainer.style.removeProperty("display")}})}function l(c){if(e.selectedDates.length===0){var h=e.config.minDate===void 0||ue(new Date,e.config.minDate)>=0?new Date:new Date(e.config.minDate.getTime()),p=ln(e.config);h.setHours(p.hours,p.minutes,p.seconds,h.getMilliseconds()),e.selectedDates=[h],e.latestSelectedDateObj=h}c!==void 0&&c.type!=="blur"&&xi(c);var _=e._input.value;f(),ve(),e._input.value!==_&&e._debouncedChange()}function d(c,h){return c%12+12*he(h===e.l10n.amPM[1])}function u(c){switch(c%24){case 0:case 12:return 12;default:return c%12}}function f(){if(!(e.hourElement===void 0||e.minuteElement===void 0)){var c=(parseInt(e.hourElement.value.slice(-2),10)||0)%24,h=(parseInt(e.minuteElement.value,10)||0)%60,p=e.secondElement!==void 0?(parseInt(e.secondElement.value,10)||0)%60:0;e.amPM!==void 0&&(c=d(c,e.amPM.textContent));var _=e.config.minTime!==void 0||e.config.minDate&&e.minDateHasTime&&e.latestSelectedDateObj&&ue(e.latestSelectedDateObj,e.config.minDate,!0)===0,C=e.config.maxTime!==void 0||e.config.maxDate&&e.maxDateHasTime&&e.latestSelectedDateObj&&ue(e.latestSelectedDateObj,e.config.maxDate,!0)===0;if(e.config.maxTime!==void 0&&e.config.minTime!==void 0&&e.config.minTime>e.config.maxTime){var D=on(e.config.minTime.getHours(),e.config.minTime.getMinutes(),e.config.minTime.getSeconds()),M=on(e.config.maxTime.getHours(),e.config.maxTime.getMinutes(),e.config.maxTime.getSeconds()),E=on(c,h,p);if(E>M&&E<D){var $=eo(D);c=$[0],h=$[1],p=$[2]}}else{if(C){var S=e.config.maxTime!==void 0?e.config.maxTime:e.config.maxDate;c=Math.min(c,S.getHours()),c===S.getHours()&&(h=Math.min(h,S.getMinutes())),h===S.getMinutes()&&(p=Math.min(p,S.getSeconds()))}if(_){var N=e.config.minTime!==void 0?e.config.minTime:e.config.minDate;c=Math.max(c,N.getHours()),c===N.getHours()&&h<N.getMinutes()&&(h=N.getMinutes()),h===N.getMinutes()&&(p=Math.max(p,N.getSeconds()))}}v(c,h,p)}}function g(c){var h=c||e.latestSelectedDateObj;h&&h instanceof Date&&v(h.getHours(),h.getMinutes(),h.getSeconds())}function v(c,h,p){e.latestSelectedDateObj!==void 0&&e.latestSelectedDateObj.setHours(c%24,h,p||0,0),!(!e.hourElement||!e.minuteElement||e.isMobile)&&(e.hourElement.value=oe(e.config.time_24hr?c:(12+c)%12+12*he(c%12===0)),e.minuteElement.value=oe(h),e.amPM!==void 0&&(e.amPM.textContent=e.l10n.amPM[he(c>=12)]),e.secondElement!==void 0&&(e.secondElement.value=oe(p)))}function k(c){var h=ce(c),p=parseInt(h.value)+(c.delta||0);(p/1e3>1||c.key==="Enter"&&!/[^\d]/.test(p.toString()))&&_t(p)}function b(c,h,p,_){if(h instanceof Array)return h.forEach(function(C){return b(c,C,p,_)});if(c instanceof Array)return c.forEach(function(C){return b(C,h,p,_)});c.addEventListener(h,p,_),e._handlers.push({remove:function(){return c.removeEventListener(h,p,_)}})}function x(){V("onChange")}function T(){if(e.config.wrap&&["open","close","toggle","clear"].forEach(function(p){Array.prototype.forEach.call(e.element.querySelectorAll("[data-"+p+"]"),function(_){return b(_,"click",e[p])})}),e.isMobile){yi();return}var c=kr(ui,50);if(e._debouncedChange=kr(x,no),e.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&b(e.daysContainer,"mouseover",function(p){e.config.mode==="range"&&bt(ce(p))}),b(e._input,"keydown",On),e.calendarContainer!==void 0&&b(e.calendarContainer,"keydown",On),!e.config.inline&&!e.config.static&&b(window,"resize",c),window.ontouchstart!==void 0?b(window.document,"touchstart",Jt):b(window.document,"mousedown",Jt),b(window.document,"focus",Jt,{capture:!0}),e.config.clickOpens===!0&&(b(e._input,"focus",e.open),b(e._input,"click",e.open)),e.daysContainer!==void 0&&(b(e.monthNav,"click",ki),b(e.monthNav,["keyup","increment"],k),b(e.daysContainer,"click",$n)),e.timeContainer!==void 0&&e.minuteElement!==void 0&&e.hourElement!==void 0){var h=function(p){return ce(p).select()};b(e.timeContainer,["increment"],l),b(e.timeContainer,"blur",l,{capture:!0}),b(e.timeContainer,"click",I),b([e.hourElement,e.minuteElement],["focus","click"],h),e.secondElement!==void 0&&b(e.secondElement,"focus",function(){return e.secondElement&&e.secondElement.select()}),e.amPM!==void 0&&b(e.amPM,"click",function(p){l(p)})}e.config.allowInput&&b(e._input,"blur",ci)}function y(c,h){var p=c!==void 0?e.parseDate(c):e.latestSelectedDateObj||(e.config.minDate&&e.config.minDate>e.now?e.config.minDate:e.config.maxDate&&e.config.maxDate<e.now?e.config.maxDate:e.now),_=e.currentYear,C=e.currentMonth;try{p!==void 0&&(e.currentYear=p.getFullYear(),e.currentMonth=p.getMonth())}catch(D){D.message="Invalid date supplied: "+p,e.config.errorHandler(D)}h&&e.currentYear!==_&&(V("onYearChange"),A()),h&&(e.currentYear!==_||e.currentMonth!==C)&&V("onMonthChange"),e.redraw()}function I(c){var h=ce(c);~h.className.indexOf("arrow")&&w(c,h.classList.contains("arrowUp")?1:-1)}function w(c,h,p){var _=c&&ce(c),C=p||_&&_.parentNode&&_.parentNode.firstChild,D=Wt("increment");D.delta=h,C&&C.dispatchEvent(D)}function O(){var c=window.document.createDocumentFragment();if(e.calendarContainer=B("div","flatpickr-calendar"),e.calendarContainer.tabIndex=-1,!e.config.noCalendar){if(c.appendChild(se()),e.innerContainer=B("div","flatpickr-innerContainer"),e.config.weekNumbers){var h=mt(),p=h.weekWrapper,_=h.weekNumbers;e.innerContainer.appendChild(p),e.weekNumbers=_,e.weekWrapper=p}e.rContainer=B("div","flatpickr-rContainer"),e.rContainer.appendChild(Me()),e.daysContainer||(e.daysContainer=B("div","flatpickr-days"),e.daysContainer.tabIndex=-1),Z(),e.rContainer.appendChild(e.daysContainer),e.innerContainer.appendChild(e.rContainer),c.appendChild(e.innerContainer)}e.config.enableTime&&c.appendChild(ge()),ie(e.calendarContainer,"rangeMode",e.config.mode==="range"),ie(e.calendarContainer,"animate",e.config.animate===!0),ie(e.calendarContainer,"multiMonth",e.config.showMonths>1),e.calendarContainer.appendChild(c);var C=e.config.appendTo!==void 0&&e.config.appendTo.nodeType!==void 0;if((e.config.inline||e.config.static)&&(e.calendarContainer.classList.add(e.config.inline?"inline":"static"),e.config.inline&&(!C&&e.element.parentNode?e.element.parentNode.insertBefore(e.calendarContainer,e._input.nextSibling):e.config.appendTo!==void 0&&e.config.appendTo.appendChild(e.calendarContainer)),e.config.static)){var D=B("div","flatpickr-wrapper");e.element.parentNode&&e.element.parentNode.insertBefore(D,e.element),D.appendChild(e.element),e.altInput&&D.appendChild(e.altInput),D.appendChild(e.calendarContainer)}!e.config.static&&!e.config.inline&&(e.config.appendTo!==void 0?e.config.appendTo:window.document.body).appendChild(e.calendarContainer)}function R(c,h,p,_){var C=Se(h,!0),D=B("span",c,h.getDate().toString());return D.dateObj=h,D.$i=_,D.setAttribute("aria-label",e.formatDate(h,e.config.ariaDateFormat)),c.indexOf("hidden")===-1&&ue(h,e.now)===0&&(e.todayDateElem=D,D.classList.add("today"),D.setAttribute("aria-current","date")),C?(D.tabIndex=-1,Yt(h)&&(D.classList.add("selected"),e.selectedDateElem=D,e.config.mode==="range"&&(ie(D,"startRange",e.selectedDates[0]&&ue(h,e.selectedDates[0],!0)===0),ie(D,"endRange",e.selectedDates[1]&&ue(h,e.selectedDates[1],!0)===0),c==="nextMonthDay"&&D.classList.add("inRange")))):D.classList.add("flatpickr-disabled"),e.config.mode==="range"&&wi(h)&&!Yt(h)&&D.classList.add("inRange"),e.weekNumbers&&e.config.showMonths===1&&c!=="prevMonthDay"&&_%7===6&&e.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+e.config.getWeek(h)+"</span>"),V("onDayCreate",D),D}function Y(c){c.focus(),e.config.mode==="range"&&bt(c)}function H(c){for(var h=c>0?0:e.config.showMonths-1,p=c>0?e.config.showMonths:-1,_=h;_!=p;_+=c)for(var C=e.daysContainer.children[_],D=c>0?0:C.children.length-1,M=c>0?C.children.length:-1,E=D;E!=M;E+=c){var $=C.children[E];if($.className.indexOf("hidden")===-1&&Se($.dateObj))return $}}function U(c,h){for(var p=c.className.indexOf("Month")===-1?c.dateObj.getMonth():e.currentMonth,_=h>0?e.config.showMonths:-1,C=h>0?1:-1,D=p-e.currentMonth;D!=_;D+=C)for(var M=e.daysContainer.children[D],E=p-e.currentMonth===D?c.$i+h:h<0?M.children.length-1:0,$=M.children.length,S=E;S>=0&&S<$&&S!=(h>0?$:-1);S+=C){var N=M.children[S];if(N.className.indexOf("hidden")===-1&&Se(N.dateObj)&&Math.abs(c.$i-S)>=Math.abs(h))return Y(N)}e.changeMonth(C),ee(H(C),0)}function ee(c,h){var p=s(),_=yt(p||document.body),C=c!==void 0?c:_?p:e.selectedDateElem!==void 0&&yt(e.selectedDateElem)?e.selectedDateElem:e.todayDateElem!==void 0&&yt(e.todayDateElem)?e.todayDateElem:H(h>0?1:-1);C===void 0?e._input.focus():_?U(C,h):Y(C)}function K(c,h){for(var p=(new Date(c,h,1).getDay()-e.l10n.firstDayOfWeek+7)%7,_=e.utils.getDaysInMonth((h-1+12)%12,c),C=e.utils.getDaysInMonth(h,c),D=window.document.createDocumentFragment(),M=e.config.showMonths>1,E=M?"prevMonthDay hidden":"prevMonthDay",$=M?"nextMonthDay hidden":"nextMonthDay",S=_+1-p,N=0;S<=_;S++,N++)D.appendChild(R("flatpickr-day "+E,new Date(c,h-1,S),S,N));for(S=1;S<=C;S++,N++)D.appendChild(R("flatpickr-day",new Date(c,h,S),S,N));for(var J=C+1;J<=42-p&&(e.config.showMonths===1||N%7!==0);J++,N++)D.appendChild(R("flatpickr-day "+$,new Date(c,h+1,J%C),J,N));var me=B("div","dayContainer");return me.appendChild(D),me}function Z(){if(e.daysContainer!==void 0){At(e.daysContainer),e.weekNumbers&&At(e.weekNumbers);for(var c=document.createDocumentFragment(),h=0;h<e.config.showMonths;h++){var p=new Date(e.currentYear,e.currentMonth,1);p.setMonth(e.currentMonth+h),c.appendChild(K(p.getFullYear(),p.getMonth()))}e.daysContainer.appendChild(c),e.days=e.daysContainer.firstChild,e.config.mode==="range"&&e.selectedDates.length===1&&bt()}}function A(){if(!(e.config.showMonths>1||e.config.monthSelectorType!=="dropdown")){var c=function(_){return e.config.minDate!==void 0&&e.currentYear===e.config.minDate.getFullYear()&&_<e.config.minDate.getMonth()?!1:!(e.config.maxDate!==void 0&&e.currentYear===e.config.maxDate.getFullYear()&&_>e.config.maxDate.getMonth())};e.monthsDropdownContainer.tabIndex=-1,e.monthsDropdownContainer.innerHTML="";for(var h=0;h<12;h++)if(c(h)){var p=B("option","flatpickr-monthDropdown-month");p.value=new Date(e.currentYear,h).getMonth().toString(),p.textContent=Lt(h,e.config.shorthandCurrentMonth,e.l10n),p.tabIndex=-1,e.currentMonth===h&&(p.selected=!0),e.monthsDropdownContainer.appendChild(p)}}}function P(){var c=B("div","flatpickr-month"),h=window.document.createDocumentFragment(),p;e.config.showMonths>1||e.config.monthSelectorType==="static"?p=B("span","cur-month"):(e.monthsDropdownContainer=B("select","flatpickr-monthDropdown-months"),e.monthsDropdownContainer.setAttribute("aria-label",e.l10n.monthAriaLabel),b(e.monthsDropdownContainer,"change",function(M){var E=ce(M),$=parseInt(E.value,10);e.changeMonth($-e.currentMonth),V("onMonthChange")}),A(),p=e.monthsDropdownContainer);var _=Ot("cur-year",{tabindex:"-1"}),C=_.getElementsByTagName("input")[0];C.setAttribute("aria-label",e.l10n.yearAriaLabel),e.config.minDate&&C.setAttribute("min",e.config.minDate.getFullYear().toString()),e.config.maxDate&&(C.setAttribute("max",e.config.maxDate.getFullYear().toString()),C.disabled=!!e.config.minDate&&e.config.minDate.getFullYear()===e.config.maxDate.getFullYear());var D=B("div","flatpickr-current-month");return D.appendChild(p),D.appendChild(_),h.appendChild(D),c.appendChild(h),{container:c,yearElement:C,monthElement:p}}function z(){At(e.monthNav),e.monthNav.appendChild(e.prevMonthNav),e.config.showMonths&&(e.yearElements=[],e.monthElements=[]);for(var c=e.config.showMonths;c--;){var h=P();e.yearElements.push(h.yearElement),e.monthElements.push(h.monthElement),e.monthNav.appendChild(h.container)}e.monthNav.appendChild(e.nextMonthNav)}function se(){return e.monthNav=B("div","flatpickr-months"),e.yearElements=[],e.monthElements=[],e.prevMonthNav=B("span","flatpickr-prev-month"),e.prevMonthNav.innerHTML=e.config.prevArrow,e.nextMonthNav=B("span","flatpickr-next-month"),e.nextMonthNav.innerHTML=e.config.nextArrow,z(),Object.defineProperty(e,"_hidePrevMonthArrow",{get:function(){return e.__hidePrevMonthArrow},set:function(c){e.__hidePrevMonthArrow!==c&&(ie(e.prevMonthNav,"flatpickr-disabled",c),e.__hidePrevMonthArrow=c)}}),Object.defineProperty(e,"_hideNextMonthArrow",{get:function(){return e.__hideNextMonthArrow},set:function(c){e.__hideNextMonthArrow!==c&&(ie(e.nextMonthNav,"flatpickr-disabled",c),e.__hideNextMonthArrow=c)}}),e.currentYearElement=e.yearElements[0],xt(),e.monthNav}function ge(){e.calendarContainer.classList.add("hasTime"),e.config.noCalendar&&e.calendarContainer.classList.add("noCalendar");var c=ln(e.config);e.timeContainer=B("div","flatpickr-time"),e.timeContainer.tabIndex=-1;var h=B("span","flatpickr-time-separator",":"),p=Ot("flatpickr-hour",{"aria-label":e.l10n.hourAriaLabel});e.hourElement=p.getElementsByTagName("input")[0];var _=Ot("flatpickr-minute",{"aria-label":e.l10n.minuteAriaLabel});if(e.minuteElement=_.getElementsByTagName("input")[0],e.hourElement.tabIndex=e.minuteElement.tabIndex=-1,e.hourElement.value=oe(e.latestSelectedDateObj?e.latestSelectedDateObj.getHours():e.config.time_24hr?c.hours:u(c.hours)),e.minuteElement.value=oe(e.latestSelectedDateObj?e.latestSelectedDateObj.getMinutes():c.minutes),e.hourElement.setAttribute("step",e.config.hourIncrement.toString()),e.minuteElement.setAttribute("step",e.config.minuteIncrement.toString()),e.hourElement.setAttribute("min",e.config.time_24hr?"0":"1"),e.hourElement.setAttribute("max",e.config.time_24hr?"23":"12"),e.hourElement.setAttribute("maxlength","2"),e.minuteElement.setAttribute("min","0"),e.minuteElement.setAttribute("max","59"),e.minuteElement.setAttribute("maxlength","2"),e.timeContainer.appendChild(p),e.timeContainer.appendChild(h),e.timeContainer.appendChild(_),e.config.time_24hr&&e.timeContainer.classList.add("time24hr"),e.config.enableSeconds){e.timeContainer.classList.add("hasSeconds");var C=Ot("flatpickr-second");e.secondElement=C.getElementsByTagName("input")[0],e.secondElement.value=oe(e.latestSelectedDateObj?e.latestSelectedDateObj.getSeconds():c.seconds),e.secondElement.setAttribute("step",e.minuteElement.getAttribute("step")),e.secondElement.setAttribute("min","0"),e.secondElement.setAttribute("max","59"),e.secondElement.setAttribute("maxlength","2"),e.timeContainer.appendChild(B("span","flatpickr-time-separator",":")),e.timeContainer.appendChild(C)}return e.config.time_24hr||(e.amPM=B("span","flatpickr-am-pm",e.l10n.amPM[he((e.latestSelectedDateObj?e.hourElement.value:e.config.defaultHour)>11)]),e.amPM.title=e.l10n.toggleTitle,e.amPM.tabIndex=-1,e.timeContainer.appendChild(e.amPM)),e.timeContainer}function Me(){e.weekdayContainer?At(e.weekdayContainer):e.weekdayContainer=B("div","flatpickr-weekdays");for(var c=e.config.showMonths;c--;){var h=B("div","flatpickr-weekdaycontainer");e.weekdayContainer.appendChild(h)}return je(),e.weekdayContainer}function je(){if(e.weekdayContainer){var c=e.l10n.firstDayOfWeek,h=xr(e.l10n.weekdays.shorthand);c>0&&c<h.length&&(h=xr(h.splice(c,h.length),h.splice(0,c)));for(var p=e.config.showMonths;p--;)e.weekdayContainer.children[p].innerHTML=`
      <span class='flatpickr-weekday'>
        `+h.join("</span><span class='flatpickr-weekday'>")+`
      </span>
      `}}function mt(){e.calendarContainer.classList.add("hasWeeks");var c=B("div","flatpickr-weekwrapper");c.appendChild(B("span","flatpickr-weekday",e.l10n.weekAbbreviation));var h=B("div","flatpickr-weeks");return c.appendChild(h),{weekWrapper:c,weekNumbers:h}}function Pe(c,h){h===void 0&&(h=!0);var p=h?c:c-e.currentMonth;p<0&&e._hidePrevMonthArrow===!0||p>0&&e._hideNextMonthArrow===!0||(e.currentMonth+=p,(e.currentMonth<0||e.currentMonth>11)&&(e.currentYear+=e.currentMonth>11?1:-1,e.currentMonth=(e.currentMonth+12)%12,V("onYearChange"),A()),Z(),V("onMonthChange"),xt())}function pt(c,h){if(c===void 0&&(c=!0),h===void 0&&(h=!0),e.input.value="",e.altInput!==void 0&&(e.altInput.value=""),e.mobileInput!==void 0&&(e.mobileInput.value=""),e.selectedDates=[],e.latestSelectedDateObj=void 0,h===!0&&(e.currentYear=e._initialDate.getFullYear(),e.currentMonth=e._initialDate.getMonth()),e.config.enableTime===!0){var p=ln(e.config),_=p.hours,C=p.minutes,D=p.seconds;v(_,C,D)}e.redraw(),c&&V("onChange")}function gt(){e.isOpen=!1,e.isMobile||(e.calendarContainer!==void 0&&e.calendarContainer.classList.remove("open"),e._input!==void 0&&e._input.classList.remove("active")),V("onClose")}function vt(){e.config!==void 0&&V("onDestroy");for(var c=e._handlers.length;c--;)e._handlers[c].remove();if(e._handlers=[],e.mobileInput)e.mobileInput.parentNode&&e.mobileInput.parentNode.removeChild(e.mobileInput),e.mobileInput=void 0;else if(e.calendarContainer&&e.calendarContainer.parentNode)if(e.config.static&&e.calendarContainer.parentNode){var h=e.calendarContainer.parentNode;if(h.lastChild&&h.removeChild(h.lastChild),h.parentNode){for(;h.firstChild;)h.parentNode.insertBefore(h.firstChild,h);h.parentNode.removeChild(h)}}else e.calendarContainer.parentNode.removeChild(e.calendarContainer);e.altInput&&(e.input.type="text",e.altInput.parentNode&&e.altInput.parentNode.removeChild(e.altInput),delete e.altInput),e.input&&(e.input.type=e.input._type,e.input.classList.remove("flatpickr-input"),e.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(function(p){try{delete e[p]}catch{}})}function De(c){return e.calendarContainer.contains(c)}function Jt(c){if(e.isOpen&&!e.config.inline){var h=ce(c),p=De(h),_=h===e.input||h===e.altInput||e.element.contains(h)||c.path&&c.path.indexOf&&(~c.path.indexOf(e.input)||~c.path.indexOf(e.altInput)),C=!_&&!p&&!De(c.relatedTarget),D=!e.config.ignoredFocusElements.some(function(M){return M.contains(h)});C&&D&&(e.config.allowInput&&e.setDate(e._input.value,!1,e.config.altInput?e.config.altFormat:e.config.dateFormat),e.timeContainer!==void 0&&e.minuteElement!==void 0&&e.hourElement!==void 0&&e.input.value!==""&&e.input.value!==void 0&&l(),e.close(),e.config&&e.config.mode==="range"&&e.selectedDates.length===1&&e.clear(!1))}}function _t(c){if(!(!c||e.config.minDate&&c<e.config.minDate.getFullYear()||e.config.maxDate&&c>e.config.maxDate.getFullYear())){var h=c,p=e.currentYear!==h;e.currentYear=h||e.currentYear,e.config.maxDate&&e.currentYear===e.config.maxDate.getFullYear()?e.currentMonth=Math.min(e.config.maxDate.getMonth(),e.currentMonth):e.config.minDate&&e.currentYear===e.config.minDate.getFullYear()&&(e.currentMonth=Math.max(e.config.minDate.getMonth(),e.currentMonth)),p&&(e.redraw(),V("onYearChange"),A())}}function Se(c,h){var p;h===void 0&&(h=!0);var _=e.parseDate(c,void 0,h);if(e.config.minDate&&_&&ue(_,e.config.minDate,h!==void 0?h:!e.minDateHasTime)<0||e.config.maxDate&&_&&ue(_,e.config.maxDate,h!==void 0?h:!e.maxDateHasTime)>0)return!1;if(!e.config.enable&&e.config.disable.length===0)return!0;if(_===void 0)return!1;for(var C=!!e.config.enable,D=(p=e.config.enable)!==null&&p!==void 0?p:e.config.disable,M=0,E=void 0;M<D.length;M++){if(E=D[M],typeof E=="function"&&E(_))return C;if(E instanceof Date&&_!==void 0&&E.getTime()===_.getTime())return C;if(typeof E=="string"){var $=e.parseDate(E,void 0,!0);return $&&$.getTime()===_.getTime()?C:!C}else if(typeof E=="object"&&_!==void 0&&E.from&&E.to&&_.getTime()>=E.from.getTime()&&_.getTime()<=E.to.getTime())return C}return!C}function yt(c){return e.daysContainer!==void 0?c.className.indexOf("hidden")===-1&&c.className.indexOf("flatpickr-disabled")===-1&&e.daysContainer.contains(c):!1}function ci(c){var h=c.target===e._input,p=e._input.value.trimEnd()!==Kt();h&&p&&!(c.relatedTarget&&De(c.relatedTarget))&&e.setDate(e._input.value,!0,c.target===e.altInput?e.config.altFormat:e.config.dateFormat)}function On(c){var h=ce(c),p=e.config.wrap?n.contains(h):h===e._input,_=e.config.allowInput,C=e.isOpen&&(!_||!p),D=e.config.inline&&p&&!_;if(c.keyCode===13&&p){if(_)return e.setDate(e._input.value,!0,h===e.altInput?e.config.altFormat:e.config.dateFormat),e.close(),h.blur();e.open()}else if(De(h)||C||D){var M=!!e.timeContainer&&e.timeContainer.contains(h);switch(c.keyCode){case 13:M?(c.preventDefault(),l(),qt()):$n(c);break;case 27:c.preventDefault(),qt();break;case 8:case 46:p&&!e.config.allowInput&&(c.preventDefault(),e.clear());break;case 37:case 39:if(!M&&!p){c.preventDefault();var E=s();if(e.daysContainer!==void 0&&(_===!1||E&&yt(E))){var $=c.keyCode===39?1:-1;c.ctrlKey?(c.stopPropagation(),Pe($),ee(H(1),0)):ee(void 0,$)}}else e.hourElement&&e.hourElement.focus();break;case 38:case 40:c.preventDefault();var S=c.keyCode===40?1:-1;e.daysContainer&&h.$i!==void 0||h===e.input||h===e.altInput?c.ctrlKey?(c.stopPropagation(),_t(e.currentYear-S),ee(H(1),0)):M||ee(void 0,S*7):h===e.currentYearElement?_t(e.currentYear-S):e.config.enableTime&&(!M&&e.hourElement&&e.hourElement.focus(),l(c),e._debouncedChange());break;case 9:if(M){var N=[e.hourElement,e.minuteElement,e.secondElement,e.amPM].concat(e.pluginElements).filter(function(le){return le}),J=N.indexOf(h);if(J!==-1){var me=N[J+(c.shiftKey?-1:1)];c.preventDefault(),(me||e._input).focus()}}else!e.config.noCalendar&&e.daysContainer&&e.daysContainer.contains(h)&&c.shiftKey&&(c.preventDefault(),e._input.focus());break}}if(e.amPM!==void 0&&h===e.amPM)switch(c.key){case e.l10n.amPM[0].charAt(0):case e.l10n.amPM[0].charAt(0).toLowerCase():e.amPM.textContent=e.l10n.amPM[0],f(),ve();break;case e.l10n.amPM[1].charAt(0):case e.l10n.amPM[1].charAt(0).toLowerCase():e.amPM.textContent=e.l10n.amPM[1],f(),ve();break}(p||De(h))&&V("onKeyDown",c)}function bt(c,h){if(h===void 0&&(h="flatpickr-day"),!(e.selectedDates.length!==1||c&&(!c.classList.contains(h)||c.classList.contains("flatpickr-disabled")))){for(var p=c?c.dateObj.getTime():e.days.firstElementChild.dateObj.getTime(),_=e.parseDate(e.selectedDates[0],void 0,!0).getTime(),C=Math.min(p,e.selectedDates[0].getTime()),D=Math.max(p,e.selectedDates[0].getTime()),M=!1,E=0,$=0,S=C;S<D;S+=to.DAY)Se(new Date(S),!0)||(M=M||S>C&&S<D,S<_&&(!E||S>E)?E=S:S>_&&(!$||S<$)&&($=S));var N=Array.from(e.rContainer.querySelectorAll("*:nth-child(-n+"+e.config.showMonths+") > ."+h));N.forEach(function(J){var me=J.dateObj,le=me.getTime(),et=E>0&&le<E||$>0&&le>$;if(et){J.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(function($e){J.classList.remove($e)});return}else if(M&&!et)return;["startRange","inRange","endRange","notAllowed"].forEach(function($e){J.classList.remove($e)}),c!==void 0&&(c.classList.add(p<=e.selectedDates[0].getTime()?"startRange":"endRange"),_<p&&le===_?J.classList.add("startRange"):_>p&&le===_&&J.classList.add("endRange"),le>=E&&($===0||le<=$)&&Qa(le,_,p)&&J.classList.add("inRange"))})}}function ui(){e.isOpen&&!e.config.static&&!e.config.inline&&wt()}function di(c,h){if(h===void 0&&(h=e._positionElement),e.isMobile===!0){if(c){c.preventDefault();var p=ce(c);p&&p.blur()}e.mobileInput!==void 0&&(e.mobileInput.focus(),e.mobileInput.click()),V("onOpen");return}else if(e._input.disabled||e.config.inline)return;var _=e.isOpen;e.isOpen=!0,_||(e.calendarContainer.classList.add("open"),e._input.classList.add("active"),V("onOpen"),wt(h)),e.config.enableTime===!0&&e.config.noCalendar===!0&&e.config.allowInput===!1&&(c===void 0||!e.timeContainer.contains(c.relatedTarget))&&setTimeout(function(){return e.hourElement.select()},50)}function Nn(c){return function(h){var p=e.config["_"+c+"Date"]=e.parseDate(h,e.config.dateFormat),_=e.config["_"+(c==="min"?"max":"min")+"Date"];p!==void 0&&(e[c==="min"?"minDateHasTime":"maxDateHasTime"]=p.getHours()>0||p.getMinutes()>0||p.getSeconds()>0),e.selectedDates&&(e.selectedDates=e.selectedDates.filter(function(C){return Se(C)}),!e.selectedDates.length&&c==="min"&&g(p),ve()),e.daysContainer&&(Pn(),p!==void 0?e.currentYearElement[c]=p.getFullYear().toString():e.currentYearElement.removeAttribute(c),e.currentYearElement.disabled=!!_&&p!==void 0&&_.getFullYear()===p.getFullYear())}}function hi(){var c=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],h=re(re({},JSON.parse(JSON.stringify(n.dataset||{}))),t),p={};e.config.parseDate=h.parseDate,e.config.formatDate=h.formatDate,Object.defineProperty(e.config,"enable",{get:function(){return e.config._enable},set:function(N){e.config._enable=Rn(N)}}),Object.defineProperty(e.config,"disable",{get:function(){return e.config._disable},set:function(N){e.config._disable=Rn(N)}});var _=h.mode==="time";if(!h.dateFormat&&(h.enableTime||_)){var C=Q.defaultConfig.dateFormat||Ye.dateFormat;p.dateFormat=h.noCalendar||_?"H:i"+(h.enableSeconds?":S":""):C+" H:i"+(h.enableSeconds?":S":"")}if(h.altInput&&(h.enableTime||_)&&!h.altFormat){var D=Q.defaultConfig.altFormat||Ye.altFormat;p.altFormat=h.noCalendar||_?"h:i"+(h.enableSeconds?":S K":" K"):D+(" h:i"+(h.enableSeconds?":S":"")+" K")}Object.defineProperty(e.config,"minDate",{get:function(){return e.config._minDate},set:Nn("min")}),Object.defineProperty(e.config,"maxDate",{get:function(){return e.config._maxDate},set:Nn("max")});var M=function(N){return function(J){e.config[N==="min"?"_minTime":"_maxTime"]=e.parseDate(J,"H:i:S")}};Object.defineProperty(e.config,"minTime",{get:function(){return e.config._minTime},set:M("min")}),Object.defineProperty(e.config,"maxTime",{get:function(){return e.config._maxTime},set:M("max")}),h.mode==="time"&&(e.config.noCalendar=!0,e.config.enableTime=!0),Object.assign(e.config,p,h);for(var E=0;E<c.length;E++)e.config[c[E]]=e.config[c[E]]===!0||e.config[c[E]]==="true";rn.filter(function(N){return e.config[N]!==void 0}).forEach(function(N){e.config[N]=sn(e.config[N]||[]).map(a)}),e.isMobile=!e.config.disableMobile&&!e.config.inline&&e.config.mode==="single"&&!e.config.disable.length&&!e.config.enable&&!e.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(var E=0;E<e.config.plugins.length;E++){var $=e.config.plugins[E](e)||{};for(var S in $)rn.indexOf(S)>-1?e.config[S]=sn($[S]).map(a).concat(e.config[S]):typeof h[S]>"u"&&(e.config[S]=$[S])}h.altInputClass||(e.config.altInputClass=Mn().className+" "+e.config.altInputClass),V("onParseConfig")}function Mn(){return e.config.wrap?n.querySelector("[data-input]"):n}function jn(){typeof e.config.locale!="object"&&typeof Q.l10ns[e.config.locale]>"u"&&e.config.errorHandler(new Error("flatpickr: invalid locale "+e.config.locale)),e.l10n=re(re({},Q.l10ns.default),typeof e.config.locale=="object"?e.config.locale:e.config.locale!=="default"?Q.l10ns[e.config.locale]:void 0),Oe.D="("+e.l10n.weekdays.shorthand.join("|")+")",Oe.l="("+e.l10n.weekdays.longhand.join("|")+")",Oe.M="("+e.l10n.months.shorthand.join("|")+")",Oe.F="("+e.l10n.months.longhand.join("|")+")",Oe.K="("+e.l10n.amPM[0]+"|"+e.l10n.amPM[1]+"|"+e.l10n.amPM[0].toLowerCase()+"|"+e.l10n.amPM[1].toLowerCase()+")";var c=re(re({},t),JSON.parse(JSON.stringify(n.dataset||{})));c.time_24hr===void 0&&Q.defaultConfig.time_24hr===void 0&&(e.config.time_24hr=e.l10n.time_24hr),e.formatDate=oi(e),e.parseDate=bn({config:e.config,l10n:e.l10n})}function wt(c){if(typeof e.config.position=="function")return void e.config.position(e,c);if(e.calendarContainer!==void 0){V("onPreCalendarPosition");var h=c||e._positionElement,p=Array.prototype.reduce.call(e.calendarContainer.children,function(Oi,Ni){return Oi+Ni.offsetHeight},0),_=e.calendarContainer.offsetWidth,C=e.config.position.split(" "),D=C[0],M=C.length>1?C[1]:null,E=h.getBoundingClientRect(),$=window.innerHeight-E.bottom,S=D==="above"||D!=="below"&&$<p&&E.top>p,N=window.pageYOffset+E.top+(S?-p-2:h.offsetHeight+2);if(ie(e.calendarContainer,"arrowTop",!S),ie(e.calendarContainer,"arrowBottom",S),!e.config.inline){var J=window.pageXOffset+E.left,me=!1,le=!1;M==="center"?(J-=(_-E.width)/2,me=!0):M==="right"&&(J-=_-E.width,le=!0),ie(e.calendarContainer,"arrowLeft",!me&&!le),ie(e.calendarContainer,"arrowCenter",me),ie(e.calendarContainer,"arrowRight",le);var et=window.document.body.offsetWidth-(window.pageXOffset+E.right),$e=J+_>window.document.body.offsetWidth,Ci=et+_>window.document.body.offsetWidth;if(ie(e.calendarContainer,"rightMost",$e),!e.config.static)if(e.calendarContainer.style.top=N+"px",!$e)e.calendarContainer.style.left=J+"px",e.calendarContainer.style.right="auto";else if(!Ci)e.calendarContainer.style.left="auto",e.calendarContainer.style.right=et+"px";else{var Vt=fi();if(Vt===void 0)return;var Di=window.document.body.offsetWidth,Si=Math.max(0,Di/2-_/2),Ei=".flatpickr-calendar.centerMost:before",Ti=".flatpickr-calendar.centerMost:after",Ii=Vt.cssRules.length,Ai="{left:"+E.left+"px;right:auto;}";ie(e.calendarContainer,"rightMost",!1),ie(e.calendarContainer,"centerMost",!0),Vt.insertRule(Ei+","+Ti+Ai,Ii),e.calendarContainer.style.left=Si+"px",e.calendarContainer.style.right="auto"}}}}function fi(){for(var c=null,h=0;h<document.styleSheets.length;h++){var p=document.styleSheets[h];if(p.cssRules){try{p.cssRules}catch{continue}c=p;break}}return c??mi()}function mi(){var c=document.createElement("style");return document.head.appendChild(c),c.sheet}function Pn(){e.config.noCalendar||e.isMobile||(A(),xt(),Z())}function qt(){e._input.focus(),window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==void 0?setTimeout(e.close,0):e.close()}function $n(c){c.preventDefault(),c.stopPropagation();var h=function(N){return N.classList&&N.classList.contains("flatpickr-day")&&!N.classList.contains("flatpickr-disabled")&&!N.classList.contains("notAllowed")},p=ai(ce(c),h);if(p!==void 0){var _=p,C=e.latestSelectedDateObj=new Date(_.dateObj.getTime()),D=(C.getMonth()<e.currentMonth||C.getMonth()>e.currentMonth+e.config.showMonths-1)&&e.config.mode!=="range";if(e.selectedDateElem=_,e.config.mode==="single")e.selectedDates=[C];else if(e.config.mode==="multiple"){var M=Yt(C);M?e.selectedDates.splice(parseInt(M),1):e.selectedDates.push(C)}else e.config.mode==="range"&&(e.selectedDates.length===2&&e.clear(!1,!1),e.latestSelectedDateObj=C,e.selectedDates.push(C),ue(C,e.selectedDates[0],!0)!==0&&e.selectedDates.sort(function(N,J){return N.getTime()-J.getTime()}));if(f(),D){var E=e.currentYear!==C.getFullYear();e.currentYear=C.getFullYear(),e.currentMonth=C.getMonth(),E&&(V("onYearChange"),A()),V("onMonthChange")}if(xt(),Z(),ve(),!D&&e.config.mode!=="range"&&e.config.showMonths===1?Y(_):e.selectedDateElem!==void 0&&e.hourElement===void 0&&e.selectedDateElem&&e.selectedDateElem.focus(),e.hourElement!==void 0&&e.hourElement!==void 0&&e.hourElement.focus(),e.config.closeOnSelect){var $=e.config.mode==="single"&&!e.config.enableTime,S=e.config.mode==="range"&&e.selectedDates.length===2&&!e.config.enableTime;($||S)&&qt()}x()}}var kt={locale:[jn,je],showMonths:[z,o,Me],minDate:[y],maxDate:[y],positionElement:[Ln],clickOpens:[function(){e.config.clickOpens===!0?(b(e._input,"focus",e.open),b(e._input,"click",e.open)):(e._input.removeEventListener("focus",e.open),e._input.removeEventListener("click",e.open))}]};function pi(c,h){if(c!==null&&typeof c=="object"){Object.assign(e.config,c);for(var p in c)kt[p]!==void 0&&kt[p].forEach(function(_){return _()})}else e.config[c]=h,kt[c]!==void 0?kt[c].forEach(function(_){return _()}):rn.indexOf(c)>-1&&(e.config[c]=sn(h));e.redraw(),ve(!0)}function Fn(c,h){var p=[];if(c instanceof Array)p=c.map(function(_){return e.parseDate(_,h)});else if(c instanceof Date||typeof c=="number")p=[e.parseDate(c,h)];else if(typeof c=="string")switch(e.config.mode){case"single":case"time":p=[e.parseDate(c,h)];break;case"multiple":p=c.split(e.config.conjunction).map(function(_){return e.parseDate(_,h)});break;case"range":p=c.split(e.l10n.rangeSeparator).map(function(_){return e.parseDate(_,h)});break}else e.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(c)));e.selectedDates=e.config.allowInvalidPreload?p:p.filter(function(_){return _ instanceof Date&&Se(_,!1)}),e.config.mode==="range"&&e.selectedDates.sort(function(_,C){return _.getTime()-C.getTime()})}function gi(c,h,p){if(h===void 0&&(h=!1),p===void 0&&(p=e.config.dateFormat),c!==0&&!c||c instanceof Array&&c.length===0)return e.clear(h);Fn(c,p),e.latestSelectedDateObj=e.selectedDates[e.selectedDates.length-1],e.redraw(),y(void 0,h),g(),e.selectedDates.length===0&&e.clear(!1),ve(h),h&&V("onChange")}function Rn(c){return c.slice().map(function(h){return typeof h=="string"||typeof h=="number"||h instanceof Date?e.parseDate(h,void 0,!0):h&&typeof h=="object"&&h.from&&h.to?{from:e.parseDate(h.from,void 0),to:e.parseDate(h.to,void 0)}:h}).filter(function(h){return h})}function vi(){e.selectedDates=[],e.now=e.parseDate(e.config.now)||new Date;var c=e.config.defaultDate||((e.input.nodeName==="INPUT"||e.input.nodeName==="TEXTAREA")&&e.input.placeholder&&e.input.value===e.input.placeholder?null:e.input.value);c&&Fn(c,e.config.dateFormat),e._initialDate=e.selectedDates.length>0?e.selectedDates[0]:e.config.minDate&&e.config.minDate.getTime()>e.now.getTime()?e.config.minDate:e.config.maxDate&&e.config.maxDate.getTime()<e.now.getTime()?e.config.maxDate:e.now,e.currentYear=e._initialDate.getFullYear(),e.currentMonth=e._initialDate.getMonth(),e.selectedDates.length>0&&(e.latestSelectedDateObj=e.selectedDates[0]),e.config.minTime!==void 0&&(e.config.minTime=e.parseDate(e.config.minTime,"H:i")),e.config.maxTime!==void 0&&(e.config.maxTime=e.parseDate(e.config.maxTime,"H:i")),e.minDateHasTime=!!e.config.minDate&&(e.config.minDate.getHours()>0||e.config.minDate.getMinutes()>0||e.config.minDate.getSeconds()>0),e.maxDateHasTime=!!e.config.maxDate&&(e.config.maxDate.getHours()>0||e.config.maxDate.getMinutes()>0||e.config.maxDate.getSeconds()>0)}function _i(){if(e.input=Mn(),!e.input){e.config.errorHandler(new Error("Invalid input element specified"));return}e.input._type=e.input.type,e.input.type="text",e.input.classList.add("flatpickr-input"),e._input=e.input,e.config.altInput&&(e.altInput=B(e.input.nodeName,e.config.altInputClass),e._input=e.altInput,e.altInput.placeholder=e.input.placeholder,e.altInput.disabled=e.input.disabled,e.altInput.required=e.input.required,e.altInput.tabIndex=e.input.tabIndex,e.altInput.type="text",e.input.setAttribute("type","hidden"),!e.config.static&&e.input.parentNode&&e.input.parentNode.insertBefore(e.altInput,e.input.nextSibling)),e.config.allowInput||e._input.setAttribute("readonly","readonly"),Ln()}function Ln(){e._positionElement=e.config.positionElement||e._input}function yi(){var c=e.config.enableTime?e.config.noCalendar?"time":"datetime-local":"date";e.mobileInput=B("input",e.input.className+" flatpickr-mobile"),e.mobileInput.tabIndex=1,e.mobileInput.type=c,e.mobileInput.disabled=e.input.disabled,e.mobileInput.required=e.input.required,e.mobileInput.placeholder=e.input.placeholder,e.mobileFormatStr=c==="datetime-local"?"Y-m-d\\TH:i:S":c==="date"?"Y-m-d":"H:i:S",e.selectedDates.length>0&&(e.mobileInput.defaultValue=e.mobileInput.value=e.formatDate(e.selectedDates[0],e.mobileFormatStr)),e.config.minDate&&(e.mobileInput.min=e.formatDate(e.config.minDate,"Y-m-d")),e.config.maxDate&&(e.mobileInput.max=e.formatDate(e.config.maxDate,"Y-m-d")),e.input.getAttribute("step")&&(e.mobileInput.step=String(e.input.getAttribute("step"))),e.input.type="hidden",e.altInput!==void 0&&(e.altInput.type="hidden");try{e.input.parentNode&&e.input.parentNode.insertBefore(e.mobileInput,e.input.nextSibling)}catch{}b(e.mobileInput,"change",function(h){e.setDate(ce(h).value,!1,e.mobileFormatStr),V("onChange"),V("onClose")})}function bi(c){if(e.isOpen===!0)return e.close();e.open(c)}function V(c,h){if(e.config!==void 0){var p=e.config[c];if(p!==void 0&&p.length>0)for(var _=0;p[_]&&_<p.length;_++)p[_](e.selectedDates,e.input.value,e,h);c==="onChange"&&(e.input.dispatchEvent(Wt("change")),e.input.dispatchEvent(Wt("input")))}}function Wt(c){var h=document.createEvent("Event");return h.initEvent(c,!0,!0),h}function Yt(c){for(var h=0;h<e.selectedDates.length;h++){var p=e.selectedDates[h];if(p instanceof Date&&ue(p,c)===0)return""+h}return!1}function wi(c){return e.config.mode!=="range"||e.selectedDates.length<2?!1:ue(c,e.selectedDates[0])>=0&&ue(c,e.selectedDates[1])<=0}function xt(){e.config.noCalendar||e.isMobile||!e.monthNav||(e.yearElements.forEach(function(c,h){var p=new Date(e.currentYear,e.currentMonth,1);p.setMonth(e.currentMonth+h),e.config.showMonths>1||e.config.monthSelectorType==="static"?e.monthElements[h].textContent=Lt(p.getMonth(),e.config.shorthandCurrentMonth,e.l10n)+" ":e.monthsDropdownContainer.value=p.getMonth().toString(),c.value=p.getFullYear().toString()}),e._hidePrevMonthArrow=e.config.minDate!==void 0&&(e.currentYear===e.config.minDate.getFullYear()?e.currentMonth<=e.config.minDate.getMonth():e.currentYear<e.config.minDate.getFullYear()),e._hideNextMonthArrow=e.config.maxDate!==void 0&&(e.currentYear===e.config.maxDate.getFullYear()?e.currentMonth+1>e.config.maxDate.getMonth():e.currentYear>e.config.maxDate.getFullYear()))}function Kt(c){var h=c||(e.config.altInput?e.config.altFormat:e.config.dateFormat);return e.selectedDates.map(function(p){return e.formatDate(p,h)}).filter(function(p,_,C){return e.config.mode!=="range"||e.config.enableTime||C.indexOf(p)===_}).join(e.config.mode!=="range"?e.config.conjunction:e.l10n.rangeSeparator)}function ve(c){c===void 0&&(c=!0),e.mobileInput!==void 0&&e.mobileFormatStr&&(e.mobileInput.value=e.latestSelectedDateObj!==void 0?e.formatDate(e.latestSelectedDateObj,e.mobileFormatStr):""),e.input.value=Kt(e.config.dateFormat),e.altInput!==void 0&&(e.altInput.value=Kt(e.config.altFormat)),c!==!1&&V("onValueUpdate")}function ki(c){var h=ce(c),p=e.prevMonthNav.contains(h),_=e.nextMonthNav.contains(h);p||_?Pe(p?-1:1):e.yearElements.indexOf(h)>=0?h.select():h.classList.contains("arrowUp")?e.changeYear(e.currentYear+1):h.classList.contains("arrowDown")&&e.changeYear(e.currentYear-1)}function xi(c){c.preventDefault();var h=c.type==="keydown",p=ce(c),_=p;e.amPM!==void 0&&p===e.amPM&&(e.amPM.textContent=e.l10n.amPM[he(e.amPM.textContent===e.l10n.amPM[0])]);var C=parseFloat(_.getAttribute("min")),D=parseFloat(_.getAttribute("max")),M=parseFloat(_.getAttribute("step")),E=parseInt(_.value,10),$=c.delta||(h?c.which===38?1:-1:0),S=E+M*$;if(typeof _.value<"u"&&_.value.length===2){var N=_===e.hourElement,J=_===e.minuteElement;S<C?(S=D+S+he(!N)+(he(N)&&he(!e.amPM)),J&&w(void 0,-1,e.hourElement)):S>D&&(S=_===e.hourElement?S-D-he(!e.amPM):C,J&&w(void 0,1,e.hourElement)),e.amPM&&N&&(M===1?S+E===23:Math.abs(S-E)>M)&&(e.amPM.textContent=e.l10n.amPM[he(e.amPM.textContent===e.l10n.amPM[0])]),_.value=oe(S)}}return i(),e}function Ke(n,t){for(var e=Array.prototype.slice.call(n).filter(function(a){return a instanceof HTMLElement}),r=[],i=0;i<e.length;i++){var s=e[i];try{if(s.getAttribute("data-fp-omit")!==null)continue;s._flatpickr!==void 0&&(s._flatpickr.destroy(),s._flatpickr=void 0),s._flatpickr=ro(s,t||{}),r.push(s._flatpickr)}catch(a){console.error(a)}}return r.length===1?r[0]:r}typeof HTMLElement<"u"&&typeof HTMLCollection<"u"&&typeof NodeList<"u"&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(n){return Ke(this,n)},HTMLElement.prototype.flatpickr=function(n){return Ke([this],n)});var Q=function(n,t){return typeof n=="string"?Ke(window.document.querySelectorAll(n),t):n instanceof Node?Ke([n],t):Ke(n,t)};Q.defaultConfig={};Q.l10ns={en:re({},ht),default:re({},ht)};Q.localize=function(n){Q.l10ns.default=re(re({},Q.l10ns.default),n)};Q.setDefaults=function(n){Q.defaultConfig=re(re({},Q.defaultConfig),n)};Q.parseDate=bn({});Q.formatDate=oi({});Q.compareDates=ue;typeof jQuery<"u"&&typeof jQuery.fn<"u"&&(jQuery.fn.flatpickr=function(n){return Ke(this,n)});Date.prototype.fp_incr=function(n){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof n=="string"?parseInt(n,10):n))};typeof window<"u"&&(window.flatpickr=Q);var it={exports:{}},io=it.exports,Cr;function so(){return Cr||(Cr=1,function(n,t){(function(e,r){r(t)})(io,function(e){var r=typeof window<"u"&&window.flatpickr!==void 0?window.flatpickr:{l10ns:{}},i={weekdays:{shorthand:["So","Mo","Di","Mi","Do","Fr","Sa"],longhand:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"]},months:{shorthand:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],longhand:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"]},firstDayOfWeek:1,weekAbbreviation:"KW",rangeSeparator:" bis ",scrollTitle:"Zum Ändern scrollen",toggleTitle:"Zum Umschalten klicken",time_24hr:!0};r.l10ns.de=i;var s=r.l10ns;e.German=i,e.default=s,Object.defineProperty(e,"__esModule",{value:!0})})}(it,it.exports)),it.exports}var ao=so();function oo(){const[n,t]=F([]),[e,r]=F(!0),[i,s]=F(null),[a,o]=F(""),[l,d]=F(""),[u,f]=F(""),[g,v]=F(""),[k,b]=F(""),[x,T]=F(null),[y,I]=F(!1),[w,O]=F(null),[R,Y]=F(()=>{const A=new Date;return`${String(A.getDate()).padStart(2,"0")}.${String(A.getMonth()+1).padStart(2,"0")}.${A.getFullYear()}`}),H=Rr(null);Ge(()=>{ee(),K(),H.current&&Q(H.current,{dateFormat:"d.m.Y",locale:ao.German,maxDate:"today",defaultDate:R,onChange:(A,P)=>{Y(P)}})},[]);function U(A){const P=String(A??"0"),z=parseFloat(P.replace(",","."));return isNaN(z)?"0,00":z.toFixed(2).replace(".",",")}async function ee(){try{r(!0),s(null);const A="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtmb3NnaW1rZnlkbGJyYW5tcXZ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE2NDAyMTEsImV4cCI6MjA1NzIxNjIxMX0.BDjsfyPBKQ3ofLw2N7dKypFzVWc0FFOQeqcmSOHKCiA",P=await fetch("https://kfosgimkfydlbranmqvv.supabase.co/functions/v1/read-tenant-sheet",{method:"GET",headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"}});if(!P.ok){const se=await P.text();throw new Error(`HTTP-Fehler ${P.status}: ${se}`)}const z=await P.json();if(!(z!=null&&z.mieter)||!Array.isArray(z.mieter))throw console.error("Unerwartetes Antwortformat:",z),new Error("Keine gültigen Mieterdaten in der Antwort erhalten.");t(z.mieter)}catch(A){console.error("Fehler beim Laden der Mieter:",A.message),s(`Die Mieterdaten konnten nicht geladen werden: ${A.message}`)}finally{r(!1)}}async function K(){try{const A="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtmb3NnaW1rZnlkbGJyYW5tcXZ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE2NDAyMTEsImV4cCI6MjA1NzIxNjIxMX0.BDjsfyPBKQ3ofLw2N7dKypFzVWc0FFOQeqcmSOHKCiA",P=await fetch("https://kfosgimkfydlbranmqvv.supabase.co/functions/v1/read-last-data-sheet",{method:"GET",headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"}});if(!P.ok){const se=await P.text();throw new Error(`HTTP-Fehler ${P.status}: ${se}`)}const z=await P.json();d(U(z.lastZaehlerstand)),v(U(z.strompreis)),b(U(z.grundpreis))}catch(A){console.error("Fehler beim Laden des letzten Zählerstands:",A.message),s(`Der letzte Zählerstand konnte nicht geladen werden: ${A.message}`)}}async function Z(){try{if(!a){O("Bitte wählen Sie einen Mieter aus.");return}if(!u){O("Bitte geben Sie einen neuen Zählerstand ein.");return}const A="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtmb3NnaW1rZnlkbGJyYW5tcXZ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE2NDAyMTEsImV4cCI6MjA1NzIxNjIxMX0.BDjsfyPBKQ3ofLw2N7dKypFzVWc0FFOQeqcmSOHKCiA",P=await fetch("https://kfosgimkfydlbranmqvv.supabase.co/functions/v1/write-meter-reading",{method:"POST",headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"},body:JSON.stringify({mieter:a,zaehlerstand:u.replace(",","."),strompreis:g.replace(",","."),grundpreis:k.replace(",","."),datum:R,sendInvoice:!1})});if(!P.ok){const se=await P.text();throw new Error(`Fehler beim Speichern des Zählerstands: ${P.status} - ${se}`)}const z=await P.json();if(O(z.message),y){const se=new FormData;se.append("mieter",a),x&&se.append("photo",x),se.append("sendInvoice","true");const ge=await fetch("https://kfosgimkfydlbranmqvv.supabase.co/functions/v1/generate-invoice",{method:"POST",headers:{Authorization:`Bearer ${A}`},body:se});if(!ge.ok){const je=await ge.text();throw new Error(`Fehler beim Generieren der Rechnung: ${ge.status} - ${je}`)}const Me=await ge.json();O(`${z.message} und ${Me.message}`)}await K(),f(""),T(null)}catch(A){console.error("Fehler beim Erfassen des Zählerstands:",A.message),O(`Fehler: ${A.message}`)}}return m("div",{className:"rounded-xl bg-white p-6 shadow-lg transition-shadow hover:shadow-xl",children:[m("div",{className:"mb-4",children:[m("label",{htmlFor:"mieter",className:"mb-2 block text-sm font-semibold text-gray-700",children:"Mieter auswählen"}),e?m("div",{className:"flex items-center justify-center py-4",children:[m("div",{className:"h-6 w-6 animate-spin rounded-full border-3 border-gray-300 border-t-blue-600"}),m("span",{className:"ml-3 text-sm text-gray-600",children:"Lade Mieter..."})]}):i?m("div",{className:"rounded-lg bg-red-50 p-4 text-sm text-red-600",children:[m("div",{className:"flex items-center",children:[m("svg",{className:"mr-2 h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:m("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i]}),m("button",{onClick:()=>{ee(),K()},className:"mt-3 rounded-md bg-red-100 px-4 py-2 text-sm font-medium text-red-700 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:"Erneut versuchen"})]}):m("select",{id:"mieter",value:a,onChange:A=>o(A.target.value),className:"mt-1 block w-full rounded-lg border border-gray-300 bg-white px-4 py-2 text-gray-700 shadow-sm transition-colors focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500 sm:text-sm",children:[m("option",{value:"",children:"Bitte wählen Sie einen Mieter"}),n.map((A,P)=>m("option",{value:A,children:A},P))]})]}),m("div",{className:"mb-4",children:[m("label",{htmlFor:"letzterZaehlerstand",className:"mb-2 block text-sm font-semibold text-gray-700",children:"Letzter Zählerstand"}),m("input",{id:"letzterZaehlerstand",value:l?`${l} kWh`:"Laden...",readOnly:!0,className:"mt-1 block w-full rounded-lg border border-gray-300 bg-gray-100 px-4 py-2 text-gray-700 shadow-sm focus:outline-none sm:text-sm"})]}),m("div",{className:"mb-4",children:[m("label",{htmlFor:"neuerZaehlerstand",className:"mb-2 block text-sm font-semibold text-gray-700",children:"Neuer Zählerstand"}),m("input",{id:"neuerZaehlerstand",value:u,onChange:A=>{const P=A.target;f(P.value.replace(/[^0-9,]/g,""))},placeholder:"z.B. 564,50",className:"mt-1 block w-full rounded-lg border border-gray-300 px-4 py-2 text-gray-700 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500 sm:text-sm"})]}),m("div",{className:"mb-4 flex space-x-4",children:[m("div",{className:"flex-1",children:[m("label",{htmlFor:"strompreis",className:"mb-2 block text-sm font-semibold text-gray-700",children:"Strompreis pro kWh"}),m("input",{id:"strompreis",value:g?`${g} €`:"Laden...",onChange:A=>{const z=A.target.value.replace(" €","").replace(/[^0-9,]/g,"");v(z)},className:"mt-1 block w-full rounded-lg border border-gray-300 px-4 py-2 text-gray-700 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500 sm:text-sm"})]}),m("div",{className:"flex-1",children:[m("label",{htmlFor:"grundpreis",className:"mb-2 block text-sm font-semibold text-gray-700",children:"Grundpreis"}),m("input",{id:"grundpreis",value:k?`${k} €`:"Laden...",onChange:A=>{const z=A.target.value.replace(" €","").replace(/[^0-9,]/g,"");b(z)},className:"mt-1 block w-full rounded-lg border border-gray-300 px-4 py-2 text-gray-700 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500 sm:text-sm"})]})]}),m("div",{className:"mb-4",children:[m("label",{htmlFor:"datum",className:"mb-2 block text-sm font-semibold text-gray-700",children:"Erfassungsdatum"}),m("input",{id:"datum",ref:H,value:R,className:"mt-1 block w-full rounded-lg border border-gray-300 px-4 py-2 text-gray-700 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500 sm:text-sm"})]}),m("div",{className:"mb-4",children:[m("label",{htmlFor:"photo",className:"mb-2 block text-sm font-semibold text-gray-700",children:"Zählerstandsfoto"}),m("input",{id:"photo",type:"file",accept:"image/*",onChange:A=>{var P;return T(((P=A.target.files)==null?void 0:P[0])||null)},className:"mt-1 block w-full text-sm text-gray-700 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),m("div",{className:"mb-4 flex justify-end items-center",children:[m("span",{className:"mr-3 text-sm font-semibold text-gray-700",children:"Rechnung"}),m("div",{className:`relative inline-block w-10 h-6 rounded-full cursor-pointer transition-colors duration-200 ease-in-out ${y?"bg-blue-600":"bg-gray-300"}`,onClick:()=>I(!y),children:m("span",{className:`absolute left-1 top-1 w-4 h-4 bg-white rounded-full transition-transform duration-200 ease-in-out transform ${y?"translate-x-4":"translate-x-0"}`})})]}),m("div",{className:"mt-6",children:m("button",{onClick:Z,className:"w-full rounded-lg bg-blue-600 px-4 py-2 text-white font-semibold hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Zählerstand erfassen"})}),w&&m("div",{className:`mt-4 rounded-lg p-4 text-sm ${w.includes("Fehler")?"bg-red-50 text-red-600":"bg-green-50 text-green-600"}`,children:w})]})}function lo({isOpen:n,onClose:t}){const[e,r]=F({anrede:"",vorname:"",nachname:"",email:"",strasse:"",hausnummer:"",plz:"",stadt:""}),[i,s]=F(""),[a,o]=F(null),[l,d]=F(!1),[u,f]=F([]),[g,v]=F(!1),k=Rr(null),b=(w,O)=>()=>{k.current&&clearTimeout(k.current),k.current=setTimeout(w,O)},x=async w=>{if(!w||w.length<3){console.log("Input zu kurz oder leer:",w),f([]),v(!1);return}console.log("Fetching suggestions for:",w);try{const O="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtmb3NnaW1rZnlkbGJyYW5tcXZ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE2NDAyMTEsImV4cCI6MjA1NzIxNjIxMX0.BDjsfyPBKQ3ofLw2N7dKypFzVWc0FFOQeqcmSOHKCiA",R=await fetch("https://kfosgimkfydlbranmqvv.supabase.co/functions/v1/autocomplete-address",{method:"POST",headers:{Authorization:`Bearer ${O}`,"Content-Type":"application/json"},body:JSON.stringify({query:w})}),Y=await R.json();console.log("Response from Supabase:",Y),R.ok?(f(Y.predictions||[]),v(!0)):(console.error("Fehler bei Autocomplete:",Y.error),o(`Fehler bei Autocomplete: ${Y.error}`))}catch(O){console.error("Fehler beim Abrufen der Vorschläge:",O),o("Fehler beim Laden der Adressvorschläge.")}};Ge(()=>{const w=b(()=>{console.log("Debounced fetch triggered with:",i),x(i)},500);return n&&w(),()=>{k.current&&clearTimeout(k.current)}},[i,n]);const T=w=>{const O=w.target.value;console.log("Input changed to:",O),s(O)},y=async w=>{var O;console.log("Selected suggestion:",w);try{const R="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtmb3NnaW1rZnlkbGJyYW5tcXZ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE2NDAyMTEsImV4cCI6MjA1NzIxNjIxMX0.BDjsfyPBKQ3ofLw2N7dKypFzVWc0FFOQeqcmSOHKCiA",Y=await fetch("https://kfosgimkfydlbranmqvv.supabase.co/functions/v1/autocomplete-address",{method:"POST",headers:{Authorization:`Bearer ${R}`,"Content-Type":"application/json"},body:JSON.stringify({place_id:w.place_id})}),H=await Y.json();if(console.log("Place Details Response:",H),Y.ok)r(U=>({...U,strasse:H.street||"",hausnummer:H.number||"",plz:H.postalCode||"",stadt:H.city||""})),s(H.street||"");else{console.error("Fehler bei Place Details:",H.error),o(`Fehler bei Place Details: ${H.error}`);const U=w.description.split(", "),ee=U[0].match(/^(.*?)\s*(\d+\w*)$/)||[U[0],U[0],""],K=ee[2]||"",Z=ee[1].trim()||U[0],A=((O=U[1].match(/^\d{5}/))==null?void 0:O[0])||"",P=U[1].replace(A,"").trim()||U[2]||"";console.log("Fallback parsed:",{strasse:Z,hausnummer:K,plz:A,stadt:P}),r(z=>({...z,strasse:Z,hausnummer:K,plz:A,stadt:P})),s(Z)}}catch(R){console.error("Fehler beim Abrufen der Adressdetails:",R),o("Fehler beim Laden der Adressdetails.")}v(!1)},I=async w=>{w.preventDefault();const{anrede:O,vorname:R,nachname:Y,email:H,strasse:U,hausnummer:ee,plz:K,stadt:Z}=e;if(!O||!R||!Y||!H||!U||!ee||!K||!Z){o("Fehler: Alle Felder sind erforderlich.");return}d(!0),o(null);try{const A="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtmb3NnaW1rZnlkbGJyYW5tcXZ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE2NDAyMTEsImV4cCI6MjA1NzIxNjIxMX0.BDjsfyPBKQ3ofLw2N7dKypFzVWc0FFOQeqcmSOHKCiA",P=await fetch("https://kfosgimkfydlbranmqvv.supabase.co/functions/v1/read-tenant-sheet",{method:"POST",headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"},body:JSON.stringify(e)}),z=await P.json();if(P.ok)o(z.message||"Mieter erfolgreich angelegt!"),r({anrede:"",vorname:"",nachname:"",email:"",strasse:"",hausnummer:"",plz:"",stadt:""}),s("");else if(P.status===409)o(z.message||"Fehler: Dieser Mieter existiert bereits.");else throw new Error(z.error||`HTTP-Fehler ${P.status}`)}catch(A){console.error("Fehler beim Anlegen des Mieters:",A.message),o(`Fehler: ${A.message}`)}finally{d(!1)}};return Ge(()=>{n||(r({anrede:"",vorname:"",nachname:"",email:"",strasse:"",hausnummer:"",plz:"",stadt:""}),s(""),o(null),f([]),v(!1),k.current&&clearTimeout(k.current))},[n]),n?m("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:m("div",{className:"flex min-h-screen items-center justify-center px-4 pb-20 pt-4 text-center sm:block sm:p-0",children:[m("div",{className:"fixed inset-0 transition-opacity",onClick:t,children:m("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),m("div",{className:"inline-block transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left align-bottom shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6 sm:align-middle",children:[m("div",{className:"absolute right-0 top-0 hidden pr-4 pt-4 sm:block",children:m("button",{type:"button",onClick:t,className:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none",children:[m("span",{className:"sr-only",children:"Schließen"}),m("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:m("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})]})}),m("div",{className:"sm:flex sm:items-start",children:m("div",{className:"mt-3 w-full text-center sm:mt-0 sm:text-left",children:[m("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Neuen Mieter anlegen"}),m("div",{className:"mt-4",children:m("form",{onSubmit:I,className:"space-y-4",children:[m("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[m("div",{children:[m("label",{htmlFor:"anrede",className:"block text-sm font-medium text-gray-700",children:"Anrede"}),m("select",{id:"anrede",value:e.anrede,onChange:w=>r({...e,anrede:w.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 py-2 pl-3 pr-10 text-base focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:l,children:[m("option",{value:"",children:"Bitte wählen"}),m("option",{value:"Herr",children:"Herr"}),m("option",{value:"Frau",children:"Frau"})]})]}),m("div",{children:[m("label",{htmlFor:"vorname",className:"block text-sm font-medium text-gray-700",children:"Vorname"}),m("input",{type:"text",id:"vorname",value:e.vorname,onChange:w=>r({...e,vorname:w.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:l})]}),m("div",{children:[m("label",{htmlFor:"nachname",className:"block text-sm font-medium text-gray-700",children:"Nachname"}),m("input",{type:"text",id:"nachname",value:e.nachname,onChange:w=>r({...e,nachname:w.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:l})]}),m("div",{children:[m("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"E-Mail"}),m("input",{type:"email",id:"email",value:e.email,onChange:w=>r({...e,email:w.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:l})]}),m("div",{className:"sm:col-span-2 relative",children:[m("label",{htmlFor:"strasse",className:"block text-sm font-medium text-gray-700",children:"Straße (mit Autovervollständigung)"}),m("input",{type:"text",id:"strasse",value:i,onChange:T,className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:l,placeholder:"Geben Sie eine Adresse ein..."}),g&&u.length>0&&m("ul",{className:"absolute z-10 w-full bg-white border border-gray-300 rounded-md mt-1 max-h-60 overflow-y-auto shadow-lg",children:u.map(w=>m("li",{className:"px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer",onClick:()=>y(w),children:w.description},w.place_id))})]}),m("div",{children:[m("label",{htmlFor:"hausnummer",className:"block text-sm font-medium text-gray-700",children:"Hausnummer"}),m("input",{type:"text",id:"hausnummer",value:e.hausnummer,onChange:w=>r({...e,hausnummer:w.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:l})]}),m("div",{children:[m("label",{htmlFor:"plz",className:"block text-sm font-medium text-gray-700",children:"PLZ"}),m("input",{type:"text",id:"plz",value:e.plz,onChange:w=>r({...e,plz:w.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:l})]}),m("div",{children:[m("label",{htmlFor:"stadt",className:"block text-sm font-medium text-gray-700",children:"Stadt"}),m("input",{type:"text",id:"stadt",value:e.stadt,onChange:w=>r({...e,stadt:w.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",disabled:l})]})]}),a&&m("div",{className:`mt-4 rounded-lg p-4 text-sm ${a.includes("Fehler")?"bg-red-50 text-red-600":"bg-green-50 text-green-600"}`,children:a}),m("div",{className:"mt-5 sm:mt-6 sm:grid sm:grid-flow-row-dense sm:grid-cols-2 sm:gap-3",children:[m("button",{type:"submit",className:"inline-flex w-full justify-center rounded-md border border-transparent bg-blue-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 sm:col-start-2 sm:text-sm disabled:bg-blue-400",disabled:l,children:l?m("svg",{className:"animate-spin h-5 w-5 text-white",viewBox:"0 0 24 24",children:[m("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),m("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8h-8z"})]}):"Anlegen"}),m("button",{type:"button",onClick:t,className:"mt-3 inline-flex w-full justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-base font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 sm:col-start-1 sm:mt-0 sm:text-sm",disabled:l,children:"Abbrechen"})]})]})})]})})]})]})}):null}function co(){const[n,t]=F([]),[e,r]=F(!0),[i,s]=F(null),[a,o]=F(""),[l,d]=F(""),[u,f]=F([]),[g,v]=F(null);Ge(()=>{k()},[]);async function k(){try{r(!0),s(null);const I=await fetch("https://kfosgimkfydlbranmqvv.supabase.co/functions/v1/read-tabelle1",{method:"GET",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtmb3NnaW1rZnlkbGJyYW5tcXZ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE2NDAyMTEsImV4cCI6MjA1NzIxNjIxMX0.BDjsfyPBKQ3ofLw2N7dKypFzVWc0FFOQeqcmSOHKCiA","Content-Type":"application/json"}});if(!I.ok)throw new Error("Fehler beim Laden der Abrechnungshistorie");const w=await I.json();if(console.log("Raw Data:",w),!Array.isArray(w))throw new Error("Erwartetes Datenformat ist kein Array");const O=w.findLastIndex(U=>U[0]&&U[0].trim()!==""),Y=(O>=0?w.slice(0,O+1):[]).filter(U=>U&&U.length>=10).map(U=>{const[ee,K,Z,A,P,,z,se,,ge,Me,je]=U,mt=parseFloat(String(A).replace(",","."))||0,Pe=parseFloat(String(P).replace(",","."))||0,pt=parseFloat(String(z).replace(",","."))||0,gt=parseFloat(String(se).replace(",","."))||0,vt=mt-Pe,De=ge?vt*pt+gt:null;return{mieter:ee||"",datum:K||"",zaehlerstand:mt,letzterZaehlerstand:Pe,verbrauch:vt,betrag:De,status:ge||"",zeitstempelEintragung:Z||"",strompreis:pt,grundpreis:gt,pdfId:Me||"",photoId:je}}),H=Array.from(new Set(Y.map(U=>U.mieter).filter(Boolean)));f(H),t(Y)}catch(y){console.error("Fehler:",y),s(y.message)}finally{r(!1)}}const b=n.filter(y=>{const I=!a||y.mieter===a,w=!l||l==="Eintrag"&&!y.status||l==="Verschickt"&&y.status;return I&&w}),x=async y=>{if(!y.pdfId){alert("Keine Rechnung verfügbar zum Download");return}try{const w=await fetch("https://kfosgimkfydlbranmqvv.supabase.co/functions/v1/download-invoice-by-id",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtmb3NnaW1rZnlkbGJyYW5tcXZ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE2NDAyMTEsImV4cCI6MjA1NzIxNjIxMX0.BDjsfyPBKQ3ofLw2N7dKypFzVWc0FFOQeqcmSOHKCiA","Content-Type":"application/json"},body:JSON.stringify({pdfId:y.pdfId})});if(!w.ok)throw new Error("Fehler beim Abrufen des Download-Links");const{downloadUrl:O}=await w.json();if(!O)throw new Error("Download-URL nicht gefunden");const R=document.createElement("a");R.href=O,R.download=`Stromabrechnung_${y.mieter}_${y.datum}.pdf`,document.body.appendChild(R),R.click(),document.body.removeChild(R)}catch(I){console.error("Download Fehler:",I),alert(`Fehler beim Herunterladen: ${I.message}`)}};async function T(y){if(!y){console.log("Keine photoId vorhanden");return}console.log("Versuche Foto-Vorschau für photoId:",y);try{const I="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtmb3NnaW1rZnlkbGJyYW5tcXZ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE2NDAyMTEsImV4cCI6MjA1NzIxNjIxMX0.BDjsfyPBKQ3ofLw2N7dKypFzVWc0FFOQeqcmSOHKCiA",w=await fetch("https://kfosgimkfydlbranmqvv.supabase.co/functions/v1/get-photo-url",{method:"POST",headers:{Authorization:`Bearer ${I}`,"Content-Type":"application/json"},body:JSON.stringify({photoId:y})});if(!w.ok){const R=await w.text();throw new Error(`Fehler beim Abrufen der Foto-URL: ${w.status} - ${R}`)}const{downloadUrl:O}=await w.json();console.log("Download-URL:",O),v(O)}catch(I){console.error("Fehler beim Laden der Foto-Vorschau:",I.message),s(`Foto-Vorschau konnte nicht geladen werden: ${I.message}`),alert(`Fehler beim Laden der Foto-Vorschau: ${I.message}`)}}return m("div",{className:"space-y-6 rounded-xl bg-white p-6 shadow-lg",children:[m("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[m("div",{children:[m("label",{className:"block text-sm font-medium text-gray-700",children:"Mieter"}),m("select",{value:a,onChange:y=>o(y.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[m("option",{value:"",children:"Alle Mieter"}),u.map(y=>m("option",{value:y,children:y},y))]})]}),m("div",{children:[m("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),m("select",{value:l,onChange:y=>d(y.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[m("option",{value:"",children:"Alle"}),m("option",{value:"Eintrag",children:"Eintrag"}),m("option",{value:"Verschickt",children:"Verschickt"})]})]})]}),e?m("div",{className:"flex items-center justify-center py-8",children:[m("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-blue-500 border-t-transparent"}),m("span",{className:"ml-3 text-gray-600",children:"Lade Abrechnungshistorie..."})]}):i?m("div",{className:"rounded-lg bg-red-50 p-4 text-red-600",children:[m("p",{children:i}),m("button",{onClick:k,className:"mt-2 rounded bg-red-100 px-4 py-2 text-red-700 hover:bg-red-200",children:"Erneut versuchen"})]}):m("div",{className:"mt-6 overflow-x-auto",children:m("table",{className:"min-w-full divide-y divide-gray-200",children:[m("thead",{className:"bg-gray-50",children:m("tr",{children:[m("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Mieter"}),m("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Datum"}),m("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Zählerstand"}),m("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Verbrauch"}),m("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Betrag"}),m("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Status"}),m("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Aktionen"})]})}),m("tbody",{className:"divide-y divide-gray-200 bg-white",children:b.map((y,I)=>m("tr",{className:"hover:bg-gray-50",children:[m("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-900",children:y.mieter}),m("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-900",children:y.datum}),m("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-900",children:[y.zaehlerstand.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})," kWh"]}),m("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-900",children:[y.verbrauch.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})," kWh"]}),m("td",{className:"whitespace-nowrap px-6 py-4 text-sm font-medium text-gray-900",children:y.betrag!==null?`${y.betrag.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})} €`:"-"}),m("td",{className:"whitespace-nowrap px-6 py-4 text-sm",children:y.status?m("span",{className:"inline-flex items-center rounded-full bg-green-100 px-2.5 py-0.5 text-xs font-medium text-green-800 cursor-pointer",title:`Rechnung verschickt am: ${y.status}`,children:"Verschickt"}):m("span",{className:"inline-flex rounded-full bg-gray-100 px-2.5 py-0.5 text-xs font-medium text-gray-800 cursor-pointer",title:`Eintragung am: ${y.zeitstempelEintragung}`,children:"Eintrag"})}),m("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500",children:[y.photoId&&m("button",{onClick:()=>T(y.photoId),className:"mr-2 text-gray-600 hover:text-blue-600 cursor-pointer",title:"Foto anzeigen",children:m("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[m("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),m("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),y.status&&m("button",{onClick:()=>x(y),className:"text-gray-600 hover:text-blue-600 cursor-pointer",title:"Download",children:m("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:m("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})})]})]},I))})]})}),g&&m("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:m("div",{className:"bg-white p-4 rounded-lg max-w-3xl max-h-[80vh] overflow-auto",children:[m("img",{src:g,alt:"Zählerstand Foto",className:"max-w-full h-auto"}),m("button",{onClick:()=>v(null),className:"mt-4 w-full rounded-lg bg-blue-600 px-4 py-2 text-white font-semibold hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Schließen"})]})})]})}function uo(){const[n,t]=F([]),[e,r]=F(!0),[i,s]=F(null),[a,o]=F({mieter:"",status:"",datumVon:"",datumBis:""});Ge(()=>{l()},[]);async function l(){try{r(!0),s(null);const f=await fetch("https://kfosgimkfydlbranmqvv.supabase.co/functions/v1/read-last-data-sheet",{headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtmb3NnaW1rZnlkbGJyYW5tcXZ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE2NDAyMTEsImV4cCI6MjA1NzIxNjIxMX0.BDjsfyPBKQ3ofLw2N7dKypFzVWc0FFOQeqcmSOHKCiA","Content-Type":"application/json"}});if(!f.ok)throw new Error("Fehler beim Laden der Verbrauchsdaten");const g=await f.json();t(g)}catch(u){s(u.message)}finally{r(!1)}}const d=n.filter(u=>(!a.mieter||u.mieter.includes(a.mieter))&&(!a.status||u.status===a.status)&&(!a.datumVon||new Date(u.datum)>=new Date(a.datumVon))&&(!a.datumBis||new Date(u.datum)<=new Date(a.datumBis)));return m("div",{className:"space-y-6 rounded-xl bg-white p-6 shadow-lg",children:[m("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[m("div",{children:[m("label",{className:"block text-sm font-medium text-gray-700",children:"Mieter"}),m("input",{type:"text",value:a.mieter,onChange:u=>o({...a,mieter:u.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Mieter filtern..."})]}),m("div",{children:[m("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),m("select",{value:a.status,onChange:u=>o({...a,status:u.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",children:[m("option",{value:"",children:"Alle"}),m("option",{value:"offen",children:"Offen"}),m("option",{value:"bezahlt",children:"Bezahlt"})]})]}),m("div",{children:[m("label",{className:"block text-sm font-medium text-gray-700",children:"Von"}),m("input",{type:"date",value:a.datumVon,onChange:u=>o({...a,datumVon:u.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]}),m("div",{children:[m("label",{className:"block text-sm font-medium text-gray-700",children:"Bis"}),m("input",{type:"date",value:a.datumBis,onChange:u=>o({...a,datumBis:u.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})]})]}),e?m("div",{className:"flex items-center justify-center py-8",children:[m("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-blue-500 border-t-transparent"}),m("span",{className:"ml-3 text-gray-600",children:"Lade Verbrauchsdaten..."})]}):i?m("div",{className:"rounded-lg bg-red-50 p-4 text-red-600",children:[m("p",{children:i}),m("button",{onClick:l,className:"mt-2 rounded bg-red-100 px-4 py-2 text-red-700 hover:bg-red-200",children:"Erneut versuchen"})]}):m("div",{className:"mt-6 overflow-x-auto",children:m("table",{className:"min-w-full divide-y divide-gray-200",children:[m("thead",{className:"bg-gray-50",children:m("tr",{children:[m("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Mieter"}),m("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Datum"}),m("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Status"}),m("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Verbrauch"}),m("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Gesamtbetrag"})]})}),m("tbody",{className:"divide-y divide-gray-200 bg-white",children:d.map((u,f)=>m("tr",{className:"hover:bg-gray-50",children:[m("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-900",children:u.mieter}),m("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-900",children:u.datum}),m("td",{className:"whitespace-nowrap px-6 py-4 text-sm",children:m("span",{className:`inline-flex rounded-full px-2 text-xs font-semibold leading-5 ${u.status==="bezahlt"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:u.status})}),m("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-900",children:[u.verbrauch," kWh"]}),m("td",{className:"whitespace-nowrap px-6 py-4 text-sm font-medium text-gray-900",children:[u.gesamtbetrag," €"]})]},f))})]})})]})}function li(){const[n,t]=F(null),[e,r]=F(!0),[i,s]=F(!1),[a,o]=F("zaehlerstand"),[l,d]=F(!1),[u,f]=F(!1);Ge(()=>{(async()=>{try{console.log("Checking session...");const{data:{session:b},error:x}=await Pt.auth.getSession();if(x)throw console.error("Session error:",x.message),x;console.log("Session:",b);const T=(b==null?void 0:b.user)??null;if(t(T),T&&b){console.log("User found, checking authorization with token:",b.access_token);const y=await fetch("https://kfosgimkfydlbranmqvv.supabase.co/functions/v1/check-authorization",{method:"GET",headers:{Authorization:`Bearer ${b.access_token}`}});if(!y.ok){const w=await y.text();throw new Error(`Authorization check failed: ${y.status} - ${w}`)}const I=await y.json();console.log("Authorization result:",I),s(I.authorized===!0)}else console.log("No user or session found")}catch(b){console.error("Error checking authorization:",b),s(!1)}finally{r(!1)}})();const{data:{subscription:k}}=Pt.auth.onAuthStateChange(async(b,x)=>{const T=(x==null?void 0:x.user)??null;if(t(T),T&&x)try{console.log("Auth state changed, checking authorization with token:",x.access_token);const y=await fetch("https://kfosgimkfydlbranmqvv.supabase.co/functions/v1/check-authorization",{method:"GET",headers:{Authorization:`Bearer ${x.access_token}`}});if(!y.ok){const w=await y.text();throw new Error(`Authorization check failed: ${y.status} - ${w}`)}const I=await y.json();console.log("Authorization result:",I),s(I.authorized===!0)}catch(y){console.error("Error checking authorization:",y),s(!1)}else console.log("Auth state changed: No user or session"),s(!1)});return()=>k.unsubscribe()},[]);const g=async()=>{await Pt.auth.signOut()};return e?m("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-b from-gray-50 to-gray-100",children:m("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent"})}):(console.log("User:",n,"IsAuthorized:",i),n?i?m("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100",children:[m("nav",{className:"bg-white shadow-md",children:m("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:m("div",{className:"flex h-16 justify-between",children:[m("div",{className:"flex",children:m("div",{className:"flex flex-shrink-0 items-center",children:[m("div",{className:"h-8 w-8 rounded bg-blue-600"}),m("span",{className:"ml-2 font-sans text-2xl font-bold tracking-tight text-gray-900 antialiased",children:"Stromabrechnung"})]})}),m("div",{className:"flex items-center space-x-4",children:[m("button",{onClick:()=>f(!0),className:"inline-flex items-center rounded-md bg-blue-50 px-4 py-2 text-sm font-medium text-blue-700 hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[m("svg",{className:"mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:m("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Mieter anlegen"]}),m("div",{className:"relative ml-3",children:[m("button",{onClick:()=>d(!l),className:"flex items-center rounded-full bg-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[m("span",{className:"sr-only",children:"Benutzermenü öffnen"}),m("div",{className:"h-8 w-8 rounded-full bg-gray-300",children:m("svg",{className:"h-8 w-8 text-gray-500",fill:"currentColor",viewBox:"0 0 24 24",children:m("path",{d:"M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z"})})})]}),l&&m("div",{className:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5",children:[m("div",{className:"px-4 py-2 text-sm text-gray-700 border-b border-gray-200",children:n.email}),m("button",{onClick:g,className:"block w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-gray-100",children:"Abmelden"})]})]})]})]})})}),m("main",{className:"p-4 sm:p-6 md:p-8",children:m("div",{className:"container mx-auto max-w-7xl",children:[m("div",{className:"mb-6 flex space-x-1 rounded-xl bg-gray-100 p-1",children:[m("button",{onClick:()=>o("zaehlerstand"),className:`flex-1 rounded-lg px-4 py-2 text-sm font-medium transition-colors ${a==="zaehlerstand"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:"Zählerstand erfassen"}),m("button",{onClick:()=>o("historie"),className:`flex-1 rounded-lg px-4 py-2 text-sm font-medium transition-colors ${a==="historie"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:"Abrechnungshistorie"}),m("button",{onClick:()=>o("analyse"),className:`flex-1 rounded-lg px-4 py-2 text-sm font-medium transition-colors ${a==="analyse"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:"Verbrauchsanalyse"})]}),a==="zaehlerstand"&&m(oo,{}),a==="historie"&&m(co,{}),a==="analyse"&&m(uo,{})]})}),m(lo,{isOpen:u,onClose:()=>f(!1)})]}):m("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-b from-gray-50 to-gray-100",children:m("div",{className:"text-center text-red-600",children:"Zugriff verweigert"})}):m(Za,{}))}$r(m(li,{}),document.getElementById("app"));$r(m(li,{}),document.getElementById("app"));export{Xi as g};
